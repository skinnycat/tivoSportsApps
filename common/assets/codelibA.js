/**
 * codelibA - v1-4-0 - 2016-03-23
 *
 * Copyright (c) 2016 Virgin Media, MultiScreen Software Development
 */
console.log("vmDtvLib remedial.js"),function(){"use strict";function a(a){return null===a||void 0===a?String(a):g[Object.prototype.toString.call(a)]||"object"}function b(b){var c,d;if("object"===a(b))for(c in b)if(d=b[c],void 0!==d&&"function"!==a(d))return!1;return!0}var c,d,e=Function("return this")(),f="Boolean Number String Function Array Date RegExp Object".split(" "),g={};for(c in f)f.hasOwnProperty(c)&&(d=f[c],g["[object "+d+"]"]=d.toLowerCase());String.prototype.entityify||(String.prototype.entityify=function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}),String.prototype.quote||(String.prototype.quote=function(){var a,b,c=this.length,d='"';for(b=0;c>b;b+=1)if(a=this.charAt(b),a>=" ")("\\"===a||'"'===a)&&(d+="\\"),d+=a;else switch(a){case"\b":d+="\\b";break;case"\f":d+="\\f";break;case"\n":d+="\\n";break;case"\r":d+="\\r";break;case"	":d+="\\t";break;default:a=a.charCodeAt(),d+="\\u00"+Math.floor(a/16).toString(16)+(a%16).toString(16)}return d+'"'}),String.prototype.supplant||(String.prototype.supplant=function(a){return this.replace(/{([^{}]*)}/g,function(b,c){var d=a[c];return"string"==typeof d||"number"==typeof d?d:b})}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s*(\S*(?:\s+\S+)*)\s*$/,"$1")}),e.typeOf=e.typeOf||a,e.isEmpty=e.isEmpty||b}(),console.log("vmDtvLib string.js"),function(){"use strict";function a(a,b){for(var c="",d=0;b>d;d++)c+=a;return c}function b(b,c){return c=c||2,a("0",c-b.toString().length)+b}var c=window.vmDtvLib=window.vmDtvLib||{};c.string={createMultiple:a,padNumber:b}}(),console.log("vmDtvLib dateTime.js"),function(){"use strict";function a(a,b){b=b||"%h:%m:%s:%z";var c=e.padNumber,d=b.replace(/%([a-zA-Z])/g,function(b,d){switch(d){case"Y":return a.getFullYear();case"M":return c(a.getMonth()+1);case"d":return c(a.getDate());case"h":return c(a.getHours());case"m":return c(a.getMinutes());case"s":return c(a.getSeconds());case"z":return c(a.getMilliseconds(),3);default:throw new Error("Unsupported format code: "+d)}});return d}function b(b){return a(new Date,b)}function c(a){var b,c,d,e="";return a>=f&&(b=Math.floor(a/f),e+=b+" day"+(b>1?"s":"")+", ",a-=b*f),a>=g&&(c=Math.floor(a/g),e+=c+" hour"+(c>1?"s":"")+", ",a-=c*g),a>=h&&(d=Math.floor(a/h),e+=d+" minute"+(d>1?"s":"")+", "),""!==e&&(e=e.substring(0,e.length-2)),e}var d=window.vmDtvLib=window.vmDtvLib||{},e=d.string,f=864e5,g=36e5,h=6e4;d.dateTime={format:a,formattedNow:b,toDaysHoursMinutes:c},Object.defineProperty(d.dateTime,"millisInDay",{get:function(){return f}}),Object.defineProperty(d.dateTime,"millisInHour",{get:function(){return g}}),Object.defineProperty(d.dateTime,"millisInMinute",{get:function(){return h}})}(),console.log("vmDtvLib util.js"),function(){"use strict";function a(){var b,c,d,e,g,h,i=arguments[0],j=1,k=arguments.length,l=!1;for("boolean"==typeof i?(l=i,i=arguments[1]||{},j=2):("object"!=typeof i&&"function"!=typeof i||null==i)&&(i={});k>j;++j)if(b=arguments[j],null!=b)for(c in b)d=i[c],e=b[c],i!==e&&(l&&e&&(f(e)||(g=Array.isArray(e)))?(g?(g=!1,h=d&&Array.isArray(d)?d:[]):h=d&&f(d)?d:{},i[c]=a(l,h,e)):void 0!==e&&(i[c]=e));return i}function b(a){return JSON.parse(JSON.stringify(a))}var c=window.vmDtvLib=window.vmDtvLib||{},d=Object.prototype.hasOwnProperty,e=Object.prototype.toString,f=function(a){if(!a||"[object Object]"!==e.call(a))return!1;var b=d.call(a,"constructor"),c=a.constructor&&a.constructor.prototype&&d.call(a.constructor.prototype,"isPrototypeOf");if(a.constructor&&!b&&!c)return!1;var f;for(f in a);return void 0===f||d.call(a,f)};c.extend=a,c.isPlainObject=f,c.clone=b}(),console.log("vmDtvLib domUtil.js"),function(){"use strict";function a(a){return a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}var b=window.vmDtvLib=window.vmDtvLib||{};b.createHtmlFrag=function(a){var b=document.createDocumentFragment(),c=document.createElement("div");for(c.innerHTML=a;c.firstChild;)b.appendChild(c.firstChild);return b},b.positionShuffle=function(a,c){var d=1024-a.offsetWidth,e=648-a.offsetHeight,f=b.getViewportCoords(a.parentElement);return setInterval(function(){a.style.left=Math.floor(Math.random()*d)-f.left+128+"px",a.style.top=Math.floor(Math.random()*e)-f.top+62+"px"},c)},b.getViewportCoords=function(a){var b=a.getBoundingClientRect(),c=document.body,d=document.documentElement,e=window.pageYOffset||d.scrollTop||c.scrollTop,f=window.pageXOffset||d.scrollLeft||c.scrollLeft,g=d.clientTop||c.clientTop||0,h=d.clientLeft||c.clientLeft||0,i=b.top+e-g,j=b.left+f-h;return{top:Math.round(i),left:Math.round(j)}},b.startScrolling=function(a,b,c){var d=a.cloneNode(!0),e="display: inline; visibility: hidden;";d.setAttribute("style",e),a.parentNode.appendChild(d);var f=d.offsetWidth,g=a.offsetWidth,h=b||50,i=c||500,j=f/h,k=f+g,l=k/h,m=function(a,b,c,d){return d===!0?"-o-transition: all "+a+"s linear "+b+"ms; -o-transform: translate("+c+"px, 0);":"-o-transition: all "+a+"s linear "+b+"ms; -o-transform: translate(-"+c+"px, 0);"},n=function(a){return"-o-transition: none; -o-transform: translate("+a+"px, 0);"};d.parentNode.removeChild(d),f>g&&(a.setAttribute("style",m(j,i,f)),a.style.overflow="visible",a.setAttribute("data-scrollingcss",a.getAttribute("style")),a.addEventListener("otransitionend",function(a){a.srcElement.setAttribute("style",""),a.srcElement.setAttribute("style",n(g)),setTimeout(function(){a.srcElement.setAttribute("style",m(l,i,f)),a.srcElement.style.overflow="visible",a.srcElement.setAttribute("data-scrollingcss",a.srcElement.getAttribute("style"))},0)},!1))},b.stopScrolling=function(b){var c=b.getAttribute("data-scrollingcss");if(void 0!==c&&null!==c){var d=new RegExp(a(c),"gi");b.setAttribute("style",b.getAttribute("style").replace(d,""))}}}(),console.log("vmDtvLib init.js"),function(){"use strict";function a(a){return d=a,this}function b(a,b){function c(){e.lib.configComponentsCb=null,d=null,a({ok:l,message:k},i,e.tivoClient)}function g(){b?(e.tivoClient=b,c()):window.tivo.client.createClient({ready:function(a){j.info("tivo client ready"),e.tivoClient=a,c()},error:function(a){l=!1,k="Unable to load tivo client. "+a,j.error(k),c()}})}function h(a,b){for(var c in b)a[c]&&b[c](a[c])}var i,j=e.logger.getInstance("vmDtvLib init"),k="",l=!0;if(j.debug("init",b?"tivoClient provided":""),!a)throw new e.error.VmError("NO_CB","init must have a cb param");e.configLoader.loadConfig(function(a){i=a;var b=a.vdl;i.vdl=void 0,delete i.vdl,e.configFileVersion=a.configFileVersion,b&&(b.log&&e.logger.setLoggingLevel(b.log.level,e.buildEnvironment),h(b,e.lib.configComponentsCb)),h(i,f),g()},function(a){l=!1,k=a.type+" : "+a.message,g()},d)}function c(a,b){f[a]=b}var d,e=window.vmDtvLib=window.vmDtvLib||{},f={};e.buildEnvironment=window.vmBuildEnvironment,e.appVersion=window.vmAppVersion,e.configFileVersion=null,e.tivoClient=null,e.lib={configComponentsCb:{},setUrlParams:a,init:b,addConfigHandler:c},e.buildEnvironment&&e.logger&&e.logger.setLoggingLevel(null,e.buildEnvironment)}(),console.log("vmDtvLib log.js"),function(){"use strict";function a(a,b){return a.log=c(l,!1,b),a.info=c(n,!1,b),a.warn=c(o,!1,b),a.debug=c(m,!1,b),a.error=c(p,!1,b),a.logD=c(l,!0,b),a.infoD=c(n,!0,b),a.warnD=c(o,!0,b),a.debugD=c(m,!0,b),a.errorD=c(p,!0,b),a}function b(a,b){g&&g(a,b)||console.log(a)}function c(a,c,e){var f=q[a],g=function(){var g,h,i=c?1:0,j=Array.prototype.slice.call(arguments,i),l=c?arguments[0]:k;if(a>=r)if(j[0]instanceof Error)b(j[0],a);else for(h=d(f,e,l,j),g=0;g<h.length-1;g++)b(h[g],a)};return g.logs=[],g}function d(a,b,c,d){var e=t.formattedNow()+i+a+i;b&&(e+=b+i);for(var g=0;g<d.length;g++)g>0&&(e+=j),e+=f(c-1,1,d[g]);return e+="\n",e.split("\n")}function e(a){return s.createMultiple(" ",a)}function f(a,b,c,d){var g="";switch(typeof c){case"object":if("null"===typeOf(c)||1>a)g=typeOf(c);else if("array"===typeOf(c)){g=e(b)+"[";for(var h=0;h<c.length;h++)0!==h&&(g+=", "),g+=f(a-1,b+1,c[h],!0);g+="]"}else{g="{\n";for(var i in c)g+=e(b)+i+": ",g+=f(a-1,b+1,c[i],!0)+"\n";g+=e(b-1)+"}"}break;case"undefined":g="undefined";break;case"boolean":case"number":g=c.toString();break;default:d&&(g='"'),g+=c.toString(),d&&(g+='"')}return g}var g,h=window.vmDtvLib=window.vmDtvLib||{},i=": ",j=", ",k=4,l=4,m=0,n=1,o=2,p=3,q=["DEBUG","INFO","WARNING","ERROR","LOG"],r=n,s=h.string,t=h.dateTime,u=a({});u.getInstance=function(b){var c=a({},b);return c},u.setLoggingLevel=function(a,b){var c=r;null!=a?r=Number(a):"DEV"===b&&(r=m),this.log("Logger, setLoggingLevel, current log level:"+c+" requested log level:"+a+" buildEnvironment:"+b+" log level set:"+r)},u.registerOutput=function(a){g=a},u.LT_DEBUG=m,u.LT_INFO=n,u.LT_WARN=o,u.LT_ERROR=p,u.LT_LOG=l,h.logger=u,h.buildEnvironment&&u.setLoggingLevel(null,h.buildEnvironment)}(),console.log("vmDtvLib VmError.js"),function(){"use strict";var a=window.vmDtvLib=window.vmDtvLib||{},b=a.error=a.error||{};a.logger.getInstance("vmDtvLib VmError");b.VmError=function(a,b){var c=Error.call(this,b);this.message=c.message,this.type=a};var c=b.VmError.prototype=Object.create(Error.prototype);b.VmError.constructor=b.VmError,c.name="VmError"}(),console.log("vmDtvLib errorUtil.js"),function(){"use strict";var a=window.vmDtvLib=window.vmDtvLib||{},b=a.error=a.error||{};b.logAndCreate=function(a,c,d){return d.error(""+a+", "+c),new b.VmError(a,c)},b.logCreateCall=function(a,c,d,e){var f=b.logAndCreate(a,c,d);return e&&e(f),f}}(),console.log("vmDtvLib localSystemHelper.js"),function(){"use strict";var a=window.vmDtvLib=window.vmDtvLib||{};a.logger.getInstance("vmDtvLib localSystemHelper");a.tivo=a.tivo||{},a.tivo.getNetworkInterface=function(a){for(var b,c=oipfObjectFactory.createConfigurationObject().localSystem,d=0;d<c.networkInterfaces.length;d++)if(b=c.networkInterfaces.item(d),b.type===a)return b;return null},a.tivo.getMacAddress=function(b){var c=a.tivo.getNetworkInterface(b);return c?c.macAddress:""}}(),console.log("vmDtvLib net.js"),function(){"use strict";function a(a,b){var c=a.indexOf(b);return-1!==c?[a.slice(0,c),a.slice(c+b.length)]:[a]}function b(b,c,d,e,f,g){var h,i,j;b||(b=""),null==f&&(f="&"),null==g&&(g="="),h=b.split(f);for(var k=0;k<h.length;k++)j=a(h[k],g),i=j[0],i&&(i=e?i:decodeURIComponent(i),d&&i&&(i=i.toLowerCase()),i&&c(i,e?j[1]:decodeURIComponent(j[1])))}function c(a,c,d,e,f,g){function h(a,b){j[a]||(j[a]=[]),j[a].push(b)}function i(a,b){j[a]=b}var j={};return b(a,g?h:i,c,d,e,f),j}function d(a,b,c,d){function f(a,f){b?i+=c+a+d+f:("string"!=typeof f&&(f=String(f)),i+=c+e(a,k)+d+e(f,l))}var g,h,i="";null==c&&(c="&"),null==d&&(d="=");for(g in a)if("array"===typeOf(a[g]))for(h=0;h<a[g].length;h++)f(g,a[g][h]);else f(g,a[g]);return i=i.substring(1)}function e(a,b){var c,d="";"string"!=typeof a&&(a="");for(var e=0;e<a.length;e++)c=a.charAt(e),c>="A"&&"Z">=c||c>="a"&&"9">=c||c>="0"&&"9">=c||b.indexOf(c)>=0||(c=escape(c)),d+=c;return d}var f=window.vmDtvLib=window.vmDtvLib||{},g="-._~",h="!$&'()*+,;=",i=g+h,j=g+h+"@",k=g+"?/:@",l=k+"=",m=g+h+"?/:@";f.netUtil={iterateNvpStr:b,nvpStrToObj:c,objToNvpStr:d,escapeStr:e,splitOnFirst:a,hostValidChars:i,pathValidChars:j,queryNameValidChars:k,queryValueValidChars:l,fragmentValidChars:m}}(),console.log("vmDtvLib url.js"),function(){"use strict";function a(){this.protocol="",this.user="",this.host="",this.port="",this.pathSegments=[],this.queryParameters={},this.fragment=""}var b=window.vmDtvLib=window.vmDtvLib||{};b.urlUtil={newUrl:function(){return new a}},b.Url=a;var c=b.logger.getInstance("vmDtvLib url"),d=b.netUtil,e=a.prototype;e.getUrl=function(a){var b="",e=[];return this.protocol&&(b+=this.protocol+":"),(this.user||this.host||this.port)&&(b+="//",this.user&&(b+=(a?this.user:d.escapeStr(this.user,d.hostValidChars))+"@"),b+=a?this.host:d.escapeStr(this.host,d.hostValidChars),this.port&&(b+=":"+this.port)),this.pathSegments.forEach(function(b,c,f){e[c]=a?b:d.escapeStr(b,d.pathValidChars)}),b+=e.join("/"),isEmpty(this.queryParameters)||(b+="?"+d.objToNvpStr(this.queryParameters,a)),this.fragment&&(b+="#"+(a?this.fragment:d.escapeStr(this.fragment,d.fragmentValidChars))),c.debug("getUrl",b),b},e.getPathExFile=function(){var a=this.getPath(),b=a.lastIndexOf("/");return-1!==b?a.substring(0,b+1):""},e.getFile=function(){return this.pathSegments.length?this.pathSegments[this.pathSegments.length-1]:""},e.getFileExtension=function(){var a=this.getFile().match("[.](.*$)");return a?a[1]:""},e.getFileName=function(){var a=this.getFile().match("(^.*?)[.]");return a?a[1]:""},e.getProtocol=function(){return this.protocol},e.getUser=function(){return this.user},e.getHost=function(){return this.host},e.getPort=function(){return this.port},e.getPath=function(){return this.pathSegments.join("/")},e.getSegments=function(){var a=[];return this.pathSegments.forEach(function(b,c){a[c]=b}),a},e.getFragment=function(){return this.fragment},e.getQuery=function(){return d.objToNvpStr(this.queryParameters)},e.getQueryParameters=function(a){var b={};for(var c in this.queryParameters)c=a?c.toLowerCase():c,b[c]=this.queryParameters[c];return b},e.getQueryParameter=function(a,b){if(!b)return this.queryParameters[a];for(var c in this.queryParameters)if(a.toLowerCase()===c.toLowerCase())return this.queryParameters[c]},e.setUrl=function(a,b){var e,f,g,h,i,j,k,l,m="",n="",o="";return this.protocol="",this.user="",this.host="",this.port="",this.queryParameters=null,this.fragment="",this.pathSegments=null,c.debug("setUrl",a),"string"!==typeOf(a)&&(a=""),f=d.splitOnFirst(a,"#"),this.fragment=f[1]?b?f[1]:decodeURIComponent(f[1]):"",g=d.splitOnFirst(f[0],"?"),null!=g[1]&&(o=g[1]),k=d.splitOnFirst(g[0],":"),k[1]?(this.protocol=k[0],l=k[1]):l=k[0],"//"===l.substr(0,2)?(l=l.substr(2),h=d.splitOnFirst(l,"/"),m=h[0],null!=h[1]&&(n="/"+h[1]),i=d.splitOnFirst(m,"@"),i[1]?(this.user=b?i[0]:decodeURIComponent(i[0]),e=i[1]):e=i[0],j=d.splitOnFirst(e,":"),this.host=b?j[0]:decodeURIComponent(j[0]),null!=j[1]&&(this.port=j[1])):n=l?l:"",this.pathSegments=n.split("/"),this.pathSegments.forEach(function(a,c,d){d[c]=b?a:decodeURIComponent(a)}),this.queryParameters=d.nvpStrToObj(o,!1,b),this},e.setFile=function(a){return"string"!==typeOf(a)&&(a=""),this.pathSegments.length&&(this.pathSegments[this.pathSegments.length-1]=a),this},e.setFileExtension=function(a){return"string"!==typeOf(a)&&(a=""),this.pathSegments.length&&(this.pathSegments[this.pathSegments.length-1]=this.getFileName()+"."+a),this},e.setFileName=function(a){return"string"!==typeOf(a)&&(a=""),this.pathSegments.length&&(this.pathSegments[this.pathSegments.length-1]=a+"."+this.getFileExtension()),this},e.setProtocol=function(a){return"string"!==typeOf(a)&&(a=""),this.protocol=a,this},e.setUser=function(a){return"string"!==typeOf(a)&&(a=""),this.user=a,this},e.setHost=function(a){return"string"!==typeOf(a)&&(a=""),this.host=a,this},e.setPort=function(a){return null==a&&(a=""),this.port=a,this},e.setPath=function(a){return"string"!==typeOf(a)&&(a=""),this.pathSegments=a.split("/"),this},e.setSegments=function(a){"array"!=typeOf(a)&&(a=[]);var b=[];return a.forEach(function(a,c){b[c]=a}),this.pathSegments=b,this},e.addFilePath=function(a){return"string"!=typeOf(a)&&(a=""),this.pathSegments=this.pathSegments.concat(a.split("/"),this.pathSegments.pop()),this},e.setFragment=function(a){return"string"!==typeOf(a)&&(a=""),this.fragment=a,this},e.setQuery=function(a){return"string"!==typeOf(a)&&(a=""),this.queryParameters=d.nvpStrToObj(a),this},e.setQueryParameters=function(a,b){"object"!=typeOf(a)&&(a={}),b||(this.queryParameters={});for(var c in a)this.queryParameters[c]=a[c];return this},e.setQueryParameter=function(a,b,c){if("string"!==typeOf(a)&&(a=""),c)for(var d in this.queryParameters)a.toLowerCase()===d.toLowerCase()&&(this.queryParameters[d]=b);else this.queryParameters[a]=b;return this},e.removeQueryParameter=function(a){return delete this.queryParameters[a],this},e.isRelative=function(){return""===this.protocol},e.makeAbsolute=function(a){var c,d,e=[];return this.isRelative()?("string"==typeof a&&(a=(new b.Url).setUrl(a)),""===this.getUrl()?(this.setUrl(a.getUrl()),this):(this.protocol=a.getProtocol(),""!==this.user||""!==this.host||""!==this.port?this:(this.host=a.getHost(),this.port=a.getPort(),this.user=a.getUser(),c=this.getPath(),"/"===c.substring(0,1)?this:""===c?(this.setPath(a.getPath()),isEmpty(this.queryParameters)&&this.setQuery(a.getQuery()),this):(this.setPath(this.setPath(a.getPath()).setFile("").getPath()+c),this.pathSegments.forEach(function(a){"."!==a&&(".."===a&&e.length&&".."!==(d=e[e.length-1])&&""!==d?e.pop():e.push(a))}),this.pathSegments=e,this)))):this}}(),console.log("vmDtvLib system.js"),function(){"use strict";function a(){return"useragent: "+navigator.userAgent+"\nappCodeName: "+navigator.appCodeName+"\nappName: "+navigator.appName+"\nappVersion: "+navigator.appVersion+"\nplatform: "+navigator.platform}function b(){return-1!==navigator.userAgent.indexOf("TiVo-Device")||-1!==navigator.userAgent.indexOf("Opera-TvEmulator")}function c(){return-1!==navigator.userAgent.indexOf("TiVo-Device")?"VM-TIVO":-1!==navigator.userAgent.indexOf("Opera-TvEmulator")?"EMULATOR":"PC"}var d=window.vmDtvLib=window.vmDtvLib||{};d.system={hasRemote:b,getBrowserDetails:a,getDeviceType:c}}(),function(){"use strict";var a=window.vmDtvLib=window.vmDtvLib||{},b=null!=window.oipfObjectFactory,c=b?27:8,d=b?"Esc":"Backspace",e=b?423:92,f=b?"MediaTrackEnd":"MacControl",g={DOWN:40,LEFT:37,RIGHT:39,UP:38,OK:13,THUMBSUP:429,THUMBSDOWN:437,CHANNELUP:425,CHANNELDOWN:424,RECORD:416,NUM0:48,NUM1:49,NUM2:50,NUM3:51,NUM4:52,NUM5:53,NUM6:54,NUM7:55,NUM8:56,NUM9:57,LASTCHAN:13,PLAY:415,PAUSE:463,SLOW:419,FORWARD:417,REVERSE:412,TEXT:459,INFO:457,STOP:413,SKIPFORWARD:e,SKIPREVERSE:c,BACK:c,YELLOW:405,BLUE:406,RED:403,GREEN:404,SUBTITLES:460},h={DOWN:"Down",LEFT:"Left",RIGHT:"Right",UP:"Up",OK:"Enter",THUMBSUP:"StoreFavorite0",THUMBSDOWN:"ClearFavorite0",CHANNELUP:"MediaTrackNext",CHANNELDOWN:"MediaTrackPrevious",RECORD:"MediaRecord",NUM0:"0",NUM1:"1",NUM2:"2",NUM3:"3",NUM4:"4",NUM5:"5",NUM6:"6",NUM7:"7",NUM8:"8",NUM9:"9",LASTCHAN:"Enter",PLAY:"MediaPlay",PAUSE:"MediaPlayPause",SLOW:"PlaySpeedDown",FORWARD:"FastFwd",REVERSE:"MediaRewind",TEXT:"Teletext",INFO:"Info",STOP:"MediaStop",SKIPFORWARD:f,SKIPREVERSE:d,BACK:d,YELLOW:"Yellow",BLUE:"Blue",RED:"Red",GREEN:"Green",SUBTITLES:"Subtitle"},i=a.logger.getInstance("vmDtvLib keys");switch(a.system.getDeviceType()){case"PC":i.debug("adding keyboard key mappings for remote keys"),g.RED=221,h.RED="]",i.debug("RED (]):",g.RED),g.GREEN=219,h.GREEN="[",i.debug("GREEN ([):",g.GREEN),g.YELLOW=220,h.YELLOW="\\",i.debug("YELLOW (\\):",g.YELLOW),g.BLUE=222,h.BLUE="#",i.debug("BLUE (#):",g.BLUE),g.STOP=35,h.STOP="End",i.debug("STOP (end KEY):",g.STOP),g.PLAY=45,h.PLAY="Insert",i.debug("PLAY (insert KEY):",g.PLAY),g.CLEAR=46,h.CLEAR="Delete",i.debug("CLEAR (delete KEY):",g.CLEAR),g.PAUSE=19,h.PAUSE="Pause",i.debug("PAUSE (pause key):",g.PAUSE),g.CHANNELUP=33,h.CHANNELUP="PageUp",i.debug("CHANNELUP (page up key):",g.CHANNELUP),g.CHANNELDOWN=34,h.CHANNELDOWN="PageDown",i.debug("CHANNELDOWN (page down key):",g.CHANNELDOWN),g.REVERSE=191,h.REVERSE="/",i.debug("REVERSE (/ key):",g.REVERSE),g.FORWARD=36,h.FORWARD="Home",i.debug("FORWARD (home key):",g.FORWARD),g.SLOW=192,h.SLOW="'",i.debug("SLOW (' key):",g.SLOW),g.SKIPFORWARD=187,h.SKIPFORWARD="=",i.debug("SKIPFORWARD (= key):",g.SKIPFORWARD),g.SKIPREVERSE=189,h.SKIPREVERSE="-",i.debug("SKIPREVERSE (- key):",g.SKIPREVERSE),g.THUMBSUP=65,h.THUMBSUP="a",i.debug("THUMBSUP (a key):",g.THUMBSUP),g.THUMBSDOWN=90,h.THUMBSDOWN="z",i.debug("THUMBSDOWN (z key):",g.THUMBSDOWN),g.RECORD=82,h.RECORD="r",i.debug("RECORD (r key):",g.RECORD),g.INFO=73,h.INFO="i",i.debug("INFO (i key):",g.INFO);break;case"EMULATOR":g.CHANNELUP=33,h.CHANNELUP="PageUp",i.debug("CHANNELUP (page up key):",g.CHANNELUP),g.CHANNELDOWN=34,h.CHANNELDOWN="PageDown",i.debug("CHANNELDOWN (page down key):",g.CHANNELDOWN)}a.keyCodes=g,a.keys=h}(),console.log("vmDtvLib tivo.js"),function(){"use strict";function a(){return"Not supported"}function b(a){return this[a]}function c(a){return a.index=b,a}function d(a,b){r[a]||(r[a]=[]),-1!==r[a].indexOf(b)&&r[a].push(b)}function e(a,b){if(r[a]){var c=r[a].indexOf(b);-1!==c&&r[a].splice(c,1)}}function f(){return o}function g(a,b){function c(a){a(b)}r[a]&&r[a].forEach(c)}function h(){o||(o=c([q])),g("SelectedComponentChanged",{componentType:1})}function i(){s.currentChannel=p,s.playState=2,o||(o=c([q])),g("PlayStateChange",{state:2}),g("ChannelChangeSucceeded",{channel:p})}function j(){return{getConditionalAccessCardId:a,getMacAddress:function(){return"00:00:00:00:00:00"},getManufacturer:a,getModel:a,getNetworkId:a,getSerialNumber:function(){return"000000000000000"},isPinSet:function(){return!0},isPinValid:k,playTiVoSound:function(a){return m.logger.debug(a)},getNavigationDirection:function(){return"TRANSITION"}}}function k(a,b){return m.logger.log("vmDtvLib tivo. not on a tivo STB, dummy client provided"),"1234"===b}function l(b){m.logger.log("vmDtvLib tivo. not on a tivo STB, dummy client provided"),setTimeout(function(){b.ready({getDevice:j,getMemory:function(){return{getGraphicsMemoryInfo:a,getMemoryInfo:a}},getLocalData:function(){return{localdataImpl:{dummy:!0},data:{},storeLocalData:function(a,b,c,d){return d(b,!0,"vmDtvLib tivo stub method")},removeLocalData:function(a,b,c){return c(b,!0,"vmDtvLib tivo stub method")},searchLocalData:function(a,b,c){return c(b,{},!0,"vmDtvLib tivo stub method")}}},getAction:function(){return{uiNavigate:function(a,b,c){m.logger.log("vmDtvLib tivo stub method"),m.logger.log("uri",a,"params",b,"forgetThisScreen",c)}}}})},0)}var m=(Function("return this")(),window.vmDtvLib=window.vmDtvLib||{}),n=window.tivo;n||(m.logger.log("vmDtvLib tivo. not on a tivo STB, dummy tivo WDK provided"),n={client:{NetworkInterfaceType:{CA_CARD:"ca_card",DOCSIS:"docsis",ETHERNET:"ethernet",EXTERNAL:"external",MOCA:"moca",WIRED:"wired",WIRELESS:"wireless"},PinType:{},TiVoSound:{ALERT:"ALERT",BONK:"BONK",DESELECT:"DESELECT",ERROR:"ERROR",LEFT:"LEFT",PAGE_DOWN:"PAGE_DOWN",PAGE_UP:"PAGE_UP",RIGHT:"RIGHT",SELECT:"SELECT",SHOWCASE_ENTER:"SHOWCASE_ENTER",SHOWCASE_EXIT:"SHOWCASE_EXIT",SIGNAL_TONE:"SIGNAL_TONE",SLOW_DOWN_1:"SLOW_DOWN_1",SPEED_UP_1:"SPEED_UP_1",SPEED_UP_2:"SPEED_UP_2",SPEED_UP_3:"SPEED_UP_3",SPEED_UP_4:"SPEED_UP_4",TAG_UP:"TAG_UP",THUMBS_DOWN:"THUMBS_DOWN",THUMBS_UP:"THUMBS_UP",TIVO:"TIVO",UP_DOWN:"UP_DOWN"},createClient:l},core:{exit:function(){var a=m.string.createMultiple("*",40);m.logger.log(a+" APPLICATION EXIT CALLED "+a)}}},window.tivo=n);var o,p={name:"not stb",majorChannel:999,networkServiceId:999},q={pid:"notStb",type:1,language:"eng"},r={},s={currentChannel:null,playState:0,COMPONENT_TYPE_AUDIO:1,release:a,getChannelConfig:function(){return{channelList:c([p]),addEventListener:function(a,b){b()},removeEventListener:a}},addEventListener:d,removeEventListener:e,selectComponent:h,bindToCurrentChannel:i,setChannel:i,getCurrentActiveComponents:f,getComponents:f,stop:a};window.oipfObjectFactory||(m.logger.log("vmDtvLib tivo. tivo hbbtv API not supported, dummy api provided"),window.oipfObjectFactory={isObjectSupported:function(){return!0},createConfigurationObject:function(){return{localSystem:{conditionalAccessCardId:"",conditionalAccessCardMac:"",modelName:"",networkId:"",serialNumber:"000000000000000",softwareVersion:"",pvrEnabled:!1,networkInterfaces:{length:0,item:function(){return null}},outputs:{length:1,item:function(){return{cgmsaMode:0,macrovisionMode:0,setCgmsaMode:a,setMacrovisionMode:a}}}}}},createParentalControlManagerObject:function(){return{purchaseControlStatus:"",getBlockUnrated:a,getParentalControlStatus:a,verifyPurchaseControlPIN:k,verifyParentalControlPIN:k,parentalRatingSchemes:{length:0,item:function(){return{}}}}},createVideoBroadcastObject:function(){return s}})}(),console.log("vmDtvLib sound.js"),function(){"use strict";function a(a){!d&&c.tivoClient&&c.tivoClient.getDevice().playTiVoSound(window.tivo.client.TiVoSound[a])}function b(a){d=a}var c=window.vmDtvLib=window.vmDtvLib||{},d=!1;c.sound=a,c.disableSound=b}(),console.log("vmDtvLib dax.js"),function(){"use strict";function a(a,b,c){u.debug("init",a,b,c);var d,e;if(a||u.error("YOU MUST SPECIFY AN APPNAME"),b||u.error("YOU MUST SPECIFY A VERSION"),u.warn("All dax logging is going to the "+(G?"test":"live")+" environment"),v=a,t.tivoClient){var f=t.tivoClient.getDevice();d=f.getSerialNumber().toLowerCase(),e=f.getMacAddress(window.tivo.client.NetworkInterfaceType.DOCSIS)}else d="stb-no-wdk",e="stb-no-wdk",u.error("NO TIVO WDK, may be vmDtvLib.lib.init not called");c||(c="loading"),p(c),x={vm_ap_nm:a,vm_ap_ver:b,vm_bid:d,vm_tsn:d,vm_mac:e,vm_vs_ct:C,vm_vs_pl:D,vm_vs_sn:E};for(var g in x)H+="&"+g+"="+x[g];u.debug("baseLabelList",H)}function b(){r("&vm_ap_start=start")}function c(a,b,c){u.debug("pageChange",a);var d="&ns_type=hidden&vm_ev_ty=nav&vm_ev_ac=in&vm_lt_asset="+a;b||(b="ok-button"),d+="&vm_ev_method="+b,c&&(d+="&vm_lt_placement="+c),r(d),p(a),setTimeout("vmDtvLib.dax.track()",500)}function d(a){u.debug("setPlaylist : obj",a),y=new J.StreamSense({},z+(G?B:A)+"/s?name="+w),y.setLabels(x),a&&a.id||u.debug("You haven't specified a playlist id/title, this default will be used: "+F);var b={};a?(b.ns_st_pl=null==a.id||""===a.id?F:a.id,a.len&&(b.ns_st_ca=a.len),a.num&&(b.ns_st_cp=a.num),a.campaign&&(b.ns_campaign=a.campaign)):b.ns_st_pl=F,y.setPlaylist(b),I="set"}function e(a){if(u.debug("updatePlaylist"),a){var b={};a.len&&(b.ns_st_ca=a.len),a.num&&(b.ns_st_cp=a.num),y.getPlaylist().setLabels(b)}}function f(){I="none"}function g(a){if(u.debug("setVideo","vid_title",a.vid_title,"playlistType",I),"set"!=I){var b={};a.vid_title&&(b.id=a.vid_title),a.vid_len&&(b.len=a.vid_len),b.num=1,d(b),I="auto"}var c={};(null==a.vid_num||""===a.vid_num)&&u.debug("You haven't specified a video number, this defaults to 1"),a.vid_id||u.error("YOU MUST SPECIFY A VIDEO ID"),a.vid_len||0==a.vid_len||u.error("YOU MUST SPECIFY A VIDEO LENGTH - SET TO ZERO IF UNKNOWN"),a.vid_title||u.error("YOU MUST SPECIFY A VIDEO TITLE"),c.ns_st_cn=null==a.vid_num||""===a.vid_num?1:a.vid_num,c.ns_st_ci=a.vid_id,c.ns_st_cl=a.vid_len,c.ns_st_pr=a.vid_title,c.ns_st_br=a.vid_bitrate?a.vid_bitrate:0,c.ns_st_pn=a.vid_part_num?a.vid_part_num:1,c.ns_st_tp=a.vid_total_parts?a.vid_total_parts:1,c.ns_st_mp=a.media_player?a.media_player:"tivo-player",c.ns_st_mv=a.media_player_ver?a.media_player_ver:"html5",y.setClip(c)}function h(a){u.debug("updateVideoDuration",a),q({ns_st_cl:Math.round(a)})}function i(a){u.debug("updateVideoBitrate",a),q({ns_st_br:a})}function j(a,b){u.debug("videoPlay",a),b||(b={}),y.notify(J.StreamSense.PlayerEvents.PLAY,b,a)}function k(a,b){u.debug("videoPause",a),b||(b={}),y.notify(J.StreamSense.PlayerEvents.PAUSE,b,a)}function l(a,b){u.debug("videoEnd",a,b);var c=b?{ns_st_pe:1}:{};y.notify(J.StreamSense.PlayerEvents.END,c,a)}function m(a,b){u.debug("trackVideoError",a,b);var c={};a&&(c.ns_st_ev=a),b&&(c.player_err=b),c.ns_type="hidden",o(c)}function n(a){u.debug("trackAppError",a),o({ns_type:"hidden",vm_ap_error:a})}function o(a){var b="";for(var c in a)b+="&"+c+"="+a[c];r(b)}function p(a){w="tivoapps."+v+"."+a+".page",u.debug("updateCounter, counter",w)}function q(a){y.getClip().setLabels(a)}function r(a){var b=z+(G?B:A)+"/s?name="+w+H+a;s(b),u.debug("trackThis",b)}function s(a){var b=document,c=b.location,d=a+"&ns__t="+(new Date).getTime();a=d+"&ns_c="+(b.characterSet?b.characterSet:b.defaultCharset)+"&ns_ti="+escape(b.title)+"&ns_jspageurl="+escape(c&&c.href?c.href:b.URL)+"&ns_referrer="+escape(b.referrer);var e=a.lastIndexOf("&");a.length>2e3&&e>=0&&(a=a.substring(0,e+1)+"ns_cut="+a.substring(e+1,a.lastIndexOf("=")).substring(0,40)),b.images?(new Image).src=a:b.write('<p><img src="'+a+'" height="1" width="1" alt="*"/></p>')}var t=window.vmDtvLib=window.vmDtvLib||{},u=t.logger.getInstance("vmDtvLib dax");t.dax={init:a,startApp:b,pageChange:c,setPlaylist:d,updatePlaylist:e,endPlaylist:f,setVideo:g,updateVideoDuration:h,updateVideoBitrate:i,videoPlay:j,videoPause:k,videoEnd:l,trackError:m,trackVideoError:m,trackAppError:n,track:o,DAX_VERSION:"1.4.0",OK_BUTTON:"ok-button",BACK_BUTTON:"back-button",LEFT_BUTTON:"left-button",RIGHT_BUTTON:"right-button",UP_BUTTON:"up-button",DOWN_BUTTON:"down-button",RED_BUTTON:"red-button",GREEN_BUTTON:"green-button",YELLOW_BUTTON:"yellow-button",BLUE_BUTTON:"blue-button"};var v,w,x,y,z="https://da.virginmedia.com/virginmedia/",A="vmmsu",B="test",C="ap",D="ti",E="ta",F="playlist",G="DEV"===t.buildEnvironment,H="",I="none";t.lib.configComponentsCb.dax=function(a){u.debug("dax config"),A=a.liveAcc||A,B=a.testAcc||B,F=a.playlistNameDefault||F,z=a.url||z,G=t.configLoader.corretToBooleanType(a.test,G)};var J=J||{};J.StreamSense=J.StreamSense||function(){function a(a){e=a}function b(a){f=a}function c(a,b){var c=a||"",d="undefined",f=g.comScore||g.sitestat||function(a){var b,c,f,i,j,k="comScore=",l=h.cookie,m="",n="indexOf",o="substring",p="length",q=2048,r="&ns_",s="&",t=g.encodeURIComponent||escape;if(l[n](k)+1)for(i=0,f=l.split(";"),j=f[p];j>i;i++)c=f[i][n](k),c+1&&(m=s+unescape(f[i][o](c+k[p])));a+=r+"_t="+ +new Date+r+"c="+(h.characterSet||h.defaultCharset||"")+m,a[p]>q&&a[n](s)>0&&(b=a[o](0,q-8).lastIndexOf(s),a=(a[o](0,b)+r+"cut="+t(a[o](b+1)))[o](0,q)),e(a),typeof ns_p===d&&(ns_p={src:a}),ns_p.lastMeasurement=a};if(typeof b!==d){var i=[],j=g.encodeURIComponent||escape;for(var k in b)b.hasOwnProperty(k)&&i.push(j(k)+"="+j(b[k]));/[\?\&]$/.test(c)||(c+="&"),c+=i.join("&")}return f(c)}function d(a,b){for(var c,d=2048,e=g.encodeURIComponent||escape,f=[],i=n.LABELS_ORDER,j=a.split("?"),k=j[0],l=j[1],m=l.split("&"),o=0,p=m.length;p>o;o++){var q=m[o].split("="),r=unescape(q[0]),s=unescape(q[1]);r&&(b[r]=s)}for(var t={},o=0,p=i.length;p>o;o++){var u=i[o];b.hasOwnProperty(u)&&(t[u]=!0,f.push(e(u)+"="+e(b[u])))}for(var u in b)t[u]||b.hasOwnProperty(u)&&f.push(e(u)+"="+e(b[u]));return c=k+"?"+f.join("&"),c=c+(c.indexOf("&c8=")<0?"&c8="+e(h.title):"")+(c.indexOf("&c7=")<0?"&c7="+e(h.URL):"")+(c.indexOf("&c9=")<0?"&c9="+e(h.referrer):""),c.length>d&&c.indexOf("&")>0&&(last=c.substr(0,d-8).lastIndexOf("&"),c=(c.substring(0,last)+"&ns_cut="+e(c.substring(last+1))).substr(0,d)),c}var e=function(a,b){},f=function(a,b,c){};a(function(a,b){var c=new Image;c.src=a,b&&setTimeout(b,0)}),b(function(a,b,c){c&&setTimeout(c,0)});var g,h,i="undefined"!=typeof window&&"undefined"!=typeof document;i?(g=window,h=document):(g={},h={location:{href:""},title:"",URL:"",referrer:"",cookie:""});var j=function(){var a={uid:function(){var a=1;return function(){return+new Date+"_"+a++}}(),filter:function(a,b){var c={};for(var d in b)b.hasOwnProperty(d)&&a(b[d])&&(c[d]=b[d]);return c},extend:function(a){var b,c=arguments.length;a=a||{};for(var d=1;c>d;d++)if(b=arguments[d])for(var e in b)b.hasOwnProperty(e)&&(a[e]=b[e]);return a},getString:function(a,b){var c=String(a);return null==a?b||"na":c},getLong:function(a,b){var c=Number(a);return null==a||isNaN(c)?b||0:c},getInteger:function(a,b){var c=Number(a);return null==a||isNaN(c)?b||0:c},getBoolean:function(a,b){var c="true"==String(a).toLowerCase();return null==a?b||!1:c},isNotEmpty:function(a){return null!=a&&a.length>0},indexOf:function(b,c){var d=-1;return a.forEach(c,function(a,c){a==b&&(d=c)}),d},forEach:function(a,b,c){try{if("function"==typeof b)if(c="undefined"!=typeof c?c:null,"number"!=typeof a.length||"undefined"==typeof a[0]){var d="undefined"!=typeof a.__proto__;for(var e in a)(!d||d&&"undefined"==typeof a.__proto__[e])&&"function"!=typeof a[e]&&b.call(c,a[e],e)}else for(var e=0,f=a.length;f>e;e++)b.call(c,a[e],e)}catch(g){}},regionMatches:function(a,b,c,d,e){if(0>b||0>d||b+e>a.length||d+e>c.length)return!1;for(;--e>=0;){var f=a.charAt(b++),g=c.charAt(d++);if(f!=g)return!1}return!0},size:function(a){var b,c=0;for(var b in a)a.hasOwnProperty(b)&&c++;return c},log:function(a,b){if("undefined"!=typeof b&&b){var c=new Date,d=c.getHours()+":"+c.getMinutes()+":"+c.getSeconds();console.log(d,a)}},isTrue:function(a){return"undefined"==typeof a?!1:"string"==typeof a?(a=a.toLowerCase(),
"true"===a||"1"===a||"on"===a):a?!0:!1},toString:function(b){if("undefined"==typeof b)return"undefined";if("string"==typeof b)return b;if("[object Array]"===Object.prototype.toString.call(b))return b.join(",");if(a.size(b)>0){var c="";for(var d in b)b.hasOwnProperty(d)&&(c+=d+":"+b[d]+";");return c}return b.toString()},exists:function(a){return"undefined"!=typeof a&&null!=a},firstGreaterThan0:function(){for(var a=0,b=arguments.length;b>a;a++){var c=arguments[a];if(c>0)return c}return 0}};return a.filterMap=function(b,c){for(var d in b)-1==a.indexOf(d,c)&&delete b[d]},a.getKeys=function(a,b){var c,d=[];for(c in a)(!b||b.test(c))&&a.hasOwnProperty(c)&&(d[d.length]=c);return d},a.getBrowserName=function(){var a,b,c=navigator.userAgent,d=navigator.appName;return-1!=(b=c.indexOf("Opera"))?d="Opera":-1!=(b=c.indexOf("MSIE"))?d="Microsoft Internet Explorer":-1!=(b=c.indexOf("Android"))?d="Android":-1!=(b=c.indexOf("Chrome"))?d="Chrome":-1!=(b=c.indexOf("Safari"))?d="Safari":-1!=(b=c.indexOf("Firefox"))?d="Firefox":-1!=(b=c.indexOf("Windows NT"))?d="Microsoft Internet Explorer":(a=c.lastIndexOf(" ")+1)<(b=c.lastIndexOf("/"))&&(d=c.substring(a,b),d.toLowerCase()==d.toUpperCase()&&(d=navigator.appName)),d},a.getBrowserFullVersion=function(){var a,b,c,d=navigator.userAgent,e=""+parseFloat(navigator.appVersion),f=parseInt(navigator.appVersion,10);return-1!=(b=d.indexOf("Opera"))?(e=d.substring(b+6),-1!=(b=d.indexOf("Version"))&&(e=d.substring(b+8))):-1!=(b=d.indexOf("MSIE"))?e=d.substring(b+5):-1!=(b=d.indexOf("Android"))?e=d.substring(b+8):-1!=(b=d.indexOf("Chrome"))?e=d.substring(b+7):-1!=(b=d.indexOf("Safari"))?(e=d.substring(b+7),-1!=(b=d.indexOf("Version"))&&(e=d.substring(b+8))):-1!=(b=d.indexOf("Firefox"))?e=d.substring(b+8):-1!=(b=d.indexOf("Windows NT"))?(b=d.indexOf("rv:"),e=d.substring(b+3)):(a=d.lastIndexOf(" ")+1)<(b=d.lastIndexOf("/"))&&(e=d.substring(b+1)),-1!=(c=e.indexOf(";"))&&(e=e.substring(0,c)),-1!=(c=e.indexOf(" "))&&(e=e.substring(0,c)),-1!=(c=e.indexOf(")"))&&(e=e.substring(0,c)),f=parseInt(""+e,10),isNaN(f)&&(e=""+parseFloat(navigator.appVersion)),e},a}(),k=function(){var a=["play","pause","end","buffer","keep-alive","hb","custom","ad_play","ad_pause","ad_end","ad_click"];return{PLAY:0,PAUSE:1,END:2,BUFFER:3,KEEP_ALIVE:4,HEART_BEAT:5,CUSTOM:6,AD_PLAY:7,AD_PAUSE:8,AD_END:9,AD_CLICK:10,toString:function(b){return a[b]}}}(),l=function(){var a=[k.END,k.PLAY,k.PAUSE,k.BUFFER];return{IDLE:0,PLAYING:1,PAUSED:2,BUFFERING:3,toEventType:function(b){return a[b]}}}(),m={ADPLAY:k.AD_PLAY,ADPAUSE:k.AD_PAUSE,ADEND:k.AD_END,ADCLICK:k.AD_CLICK},n={STREAMSENSE_VERSION:"4.1404.28",DEFAULT_PLAYERNAME:"streamsense",DEFAULT_HEARTBEAT_INTERVAL:[{playingtime:6e4,interval:1e4},{playingtime:null,interval:6e4}],DEFAULT_KEEP_ALIVE_INTERVAL:12e5,DEFAULT_PAUSED_ON_BUFFERING_INTERVAL:500,C1_VALUE:"19",C10_VALUE:"js",NS_AP_C12M_VALUE:"1",NS_NC_VALUE:"1",PAGE_NAME_LABEL:"name",LABELS_ORDER:["c1","c2","ns_site","ns_vsite","ns_ap_an","ns_ap_pn","ns_ap_pv","c12","name","ns_ak","ns_ap_ec","ns_ap_ev","ns_ap_device","ns_ap_id","ns_ap_csf","ns_ap_bi","ns_ap_pfm","ns_ap_pfv","ns_ap_ver","ns_ap_sv","ns_type","ns_radio","ns_nc","ns_ap_ui","ns_ap_gs","ns_st_sv","ns_st_pv","ns_st_it","ns_st_id","ns_st_ec","ns_st_sp","ns_st_sq","ns_st_cn","ns_st_ev","ns_st_po","ns_st_cl","ns_st_el","ns_st_pb","ns_st_hc","ns_st_mp","ns_st_mv","ns_st_pn","ns_st_tp","ns_st_pt","ns_st_pa","ns_st_ad","ns_st_li","ns_st_ci","ns_ap_jb","ns_ap_res","ns_ap_c12m","ns_ap_install","ns_ap_updated","ns_ap_lastrun","ns_ap_cs","ns_ap_runs","ns_ap_usage","ns_ap_fg","ns_ap_ft","ns_ap_dft","ns_ap_bt","ns_ap_dbt","ns_ap_dit","ns_ap_as","ns_ap_das","ns_ap_it","ns_ap_uc","ns_ap_aus","ns_ap_daus","ns_ap_us","ns_ap_dus","ns_ap_ut","ns_ap_oc","ns_ap_uxc","ns_ap_uxs","ns_ap_lang","ns_ap_miss","ns_ts","ns_st_ca","ns_st_cp","ns_st_er","ns_st_pe","ns_st_ui","ns_st_bc","ns_st_bt","ns_st_bp","ns_st_pc","ns_st_pp","ns_st_br","ns_st_ub","ns_st_vo","ns_st_ws","ns_st_pl","ns_st_pr","ns_st_ep","ns_st_ty","ns_st_cs","ns_st_ge","ns_st_st","ns_st_dt","ns_st_ct","ns_st_de","ns_st_pu","ns_st_cu","ns_st_fee","c7","c8","c9"]},o=function(){var a=function(){function a(a,b){var d=b[a];null!=d&&(c[a]=d)}var b,c,d=this,e=0,f=0,g=0,h=0,i=0,m=0;j.extend(this,{reset:function(a){null!=a&&a.length>0?j.filterMap(c,a):c={},c.hasOwnProperty("ns_st_cl")||(c.ns_st_cl="0"),c.hasOwnProperty("ns_st_pn")||(c.ns_st_pn="1"),c.hasOwnProperty("ns_st_tp")||(c.ns_st_tp="1"),d.setPauses(0),d.setStarts(0),d.setBufferingTime(0),d.setBufferingTimestamp(-1),d.setPlaybackTime(0),d.setPlaybackTimestamp(-1)},setLabels:function(a,b){null!=a&&j.extend(c,a),d.setRegisters(c,b)},getLabels:function(){return c},setLabel:function(a,b){var c={};c[a]=b,d.setLabels(c,null)},getLabel:function(a){return c[a]},getClipId:function(){return("undefined"==typeof b||null==b)&&d.setClipId("1"),b},setClipId:function(a){b=a},setRegisters:function(b,c){var h=b.ns_st_cn;null!=h&&(d.setClipId(h),delete b.ns_st_cn),h=b.ns_st_bt,null!=h&&(g=Number(h),delete b.ns_st_bt),a("ns_st_cl",b),a("ns_st_pn",b),a("ns_st_tp",b),a("ns_st_ub",b),a("ns_st_br",b),(c==l.PLAYING||null==c)&&(h=b.ns_st_sq,null!=h&&(f=Number(h),delete b.ns_st_sq)),c!=l.BUFFERING&&(h=b.ns_st_pt,null!=h&&(i=Number(h),delete b.ns_st_pt)),(c==l.PAUSED||c==l.IDLE||null==c)&&(h=b.ns_st_pc,null!=h&&(e=Number(h),delete b.ns_st_pc))},createLabels:function(a,b){var c=b||{};return c.ns_st_cn=d.getClipId(),c.ns_st_bt=String(d.getBufferingTime()),(a==k.PLAY||null==a)&&(c.ns_st_sq=String(f)),(a==k.PAUSE||a==k.END||a==k.KEEP_ALIVE||a==k.HEART_BEAT||null==a)&&(c.ns_st_pt=String(d.getPlaybackTime()),c.ns_st_pc=String(e)),j.extend(c,d.getLabels()),c},incrementPauses:function(){e++},incrementStarts:function(){f++},getBufferingTime:function(){var a=g;return h>=0&&(a+=+new Date-h),a},setBufferingTime:function(a){g=a},getPlaybackTime:function(){var a=i;return m>=0&&(a+=+new Date-m),a},setPlaybackTime:function(a){i=a},getPlaybackTimestamp:function(){return m},setPlaybackTimestamp:function(a){m=a},getBufferingTimestamp:function(){return h},setBufferingTimestamp:function(a){h=a},getPauses:function(){return e},setPauses:function(a){e=a},getStarts:function(){return f},setStarts:function(a){f=a}}),c={},d.reset()};return a}(),p=function(){var a=function(){var a,b,c=this,d=null,e=0,f=0,g=0,h=0,i=0,m=0,n=!1;j.extend(this,{reset:function(a){null!=a&&a.length>0?j.filterMap(b,a):b={},c.setPlaylistId(+new Date+"_"+m),c.setBufferingTime(0),c.setPlaybackTime(0),c.setPauses(0),c.setStarts(0),c.setRebufferCount(0),n=!1},setLabels:function(a,d){null!=a&&j.extend(b,a),c.setRegisters(b,d)},getLabels:function(){return b},setLabel:function(a,b){var d={};d[a]=b,c.setLabels(d,null)},getLabel:function(a){return b[a]},getClip:function(){return d},getPlaylistId:function(){return a},setPlaylistId:function(b){a=b},setRegisters:function(b,c){var d=b.ns_st_sp;null!=d&&(e=Number(d),delete b.ns_st_sp),d=b.ns_st_bc,null!=d&&(g=Number(d),delete b.ns_st_bc),d=b.ns_st_bp,null!=d&&(h=Number(d),delete b.ns_st_bp),d=b.ns_st_id,null!=d&&(a=d,delete b.ns_st_id),c!=l.BUFFERING&&(d=b.ns_st_pa,null!=d&&(i=Number(d),delete b.ns_st_pa)),(c==l.PAUSED||c==l.IDLE||null==c)&&(d=b.ns_st_pp,null!=d&&(f=Number(d),delete b.ns_st_pp))},createLabels:function(b,d){var h=d||{};return h.ns_st_bp=String(c.getBufferingTime()),h.ns_st_sp=String(e),h.ns_st_id=String(a),g>0&&(h.ns_st_bc=String(g)),(b==k.PAUSE||b==k.END||b==k.KEEP_ALIVE||b==k.HEART_BEAT||null==b)&&(h.ns_st_pa=String(c.getPlaybackTime()),h.ns_st_pp=String(f)),(b==k.PLAY||null==b)&&(c.didFirstPlayOccurred()||(h.ns_st_pb="1",c.setFirstPlayOccurred(!0))),j.extend(h,c.getLabels()),h},incrementStarts:function(){e++},incrementPauses:function(){f++,d.incrementPauses()},setPlaylistCounter:function(a){m=a},incrementPlaylistCounter:function(){m++},addPlaybackTime:function(a){if(d.getPlaybackTimestamp()>=0){var b=a-d.getPlaybackTimestamp();d.setPlaybackTimestamp(-1),d.setPlaybackTime(d.getPlaybackTime()+b),c.setPlaybackTime(c.getPlaybackTime()+b)}},addBufferingTime:function(a){if(d.getBufferingTimestamp()>=0){var b=a-d.getBufferingTimestamp();d.setBufferingTimestamp(-1),d.setBufferingTime(d.getBufferingTime()+b),c.setBufferingTime(c.getBufferingTime()+b)}},getBufferingTime:function(){var a=h;return d.getBufferingTimestamp()>=0&&(a+=+new Date-d.getBufferingTimestamp()),a},setBufferingTime:function(a){h=a},getPlaybackTime:function(){var a=i;return d.getPlaybackTimestamp()>=0&&(a+=+new Date-d.getPlaybackTimestamp()),a},setPlaybackTime:function(a){i=a},getStarts:function(){return e},setStarts:function(a){e=a},getPauses:function(){return f},setPauses:function(a){f=a},getRebufferCount:function(){return g},incrementRebufferCount:function(){g++},setRebufferCount:function(a){g=a},didFirstPlayOccurred:function(){return n},setFirstPlayOccurred:function(a){n=a}}),d=new o,b={},c.reset()};return a}(),q=function(){var f=function(f,g){function h(a){var b=0;if(null!=pa)for(var c=0;c<pa.length;c++){var d=pa[c],e=d.playingtime;if(!e||e>a){b=d.interval;break}}return b}function i(){r();var a=h(ma.getClip().getPlaybackTime());if(a>0){var b=sa>0?sa:a;aa=setTimeout(q,b)}sa=0}function m(){r();var a=h(ma.getClip().getPlaybackTime());sa=a-ma.getClip().getPlaybackTime()%a,null!=aa&&r()}function o(){sa=0,ua=0,ta=0}function q(){ta++;var a=Q(k.HEART_BEAT,null);D(a),sa=0,i()}function r(){null!=aa&&(clearTimeout(aa),aa=null)}function s(){u(),_=setTimeout(t,qa)}function t(){var a=Q(k.KEEP_ALIVE,null);D(a),la++,s()}function u(){null!=_&&(clearTimeout(_),_=null)}function v(){x(),ga.isPauseOnBufferingEnabled()&&I(l.PAUSED)&&($=setTimeout(w,ra))}function w(){if(ba==l.PLAYING){ma.incrementRebufferCount(),ma.incrementPauses();var a=Q(k.PAUSE,null);D(a),la++,ba=l.PAUSED}}function x(){null!=$&&(clearTimeout($),$=null)}function y(a){return a==l.PLAYING||a==l.PAUSED}function z(){W&&(clearInterval(W),W=null)}function A(a){return a==k.PLAY?l.PLAYING:a==k.PAUSE?l.PAUSED:a==k.BUFFER?l.BUFFERING:a==k.END?l.IDLE:null}function B(a,b,c){if(z(),M(a))if(c)W=setInterval(function(){B(a,b)},c);else{var d=O(),e=ja,f=L(b),g=e>=0?f-e:0;G(O(),b),H(a,b),P(O()),N(a);for(var h=0,i=fa.length;i>h;h++)fa[h](d,a,b,g);C(b),ma.setRegisters(b,a),ma.getClip().setRegisters(b,a);var k=Q(l.toEventType(a),b);j.extend(k,b),I(Y)&&(D(k),ba=Y,la++)}}function C(a){var b=a.ns_st_mp;null!=b&&(ca=b,delete a.ns_st_mp),b=a.ns_st_mv,null!=b&&(da=b,delete a.ns_st_mv),b=a.ns_st_ec,null!=b&&(la=Number(b),delete a.ns_st_ec)}function D(a,b){void 0===b&&(b=!0),b&&F(a);var c=ga.getPixelURL();if(Z){if(!E()){var f=wa.am,g=wa.et,h=f.newApplicationMeasurement(Z,g.HIDDEN,a,c);Z.getQueue().offer(h)}}else c&&e(d(c,a))}function E(){var a=Z.getAppContext(),b=Z.getSalt(),c=Z.getPixelURL();return null==a||null==b||0==b.length||null==c||0==c.length}function F(a){ea=Q(null),j.extend(ea,a)}function G(a,b){var c=L(b);if(a==l.PLAYING)ma.addPlaybackTime(c),m(),u();else if(a==l.BUFFERING)ma.addBufferingTime(c),x();else if(a==l.IDLE){var d=j.getKeys(ma.getClip().getLabels());ma.getClip().reset(d)}}function H(a,b){var c=L(b),d=K(b);ka=d,a==l.PLAYING?(i(),s(),ma.getClip().setPlaybackTimestamp(c),I(a)&&(ma.getClip().incrementStarts(),ma.getStarts()<1&&ma.setStarts(1))):a==l.PAUSED?I(a)&&ma.incrementPauses():a==l.BUFFERING?(ma.getClip().setBufferingTimestamp(c),oa&&v()):a==l.IDLE&&o()}function I(a){return a!=l.PAUSED||ba!=l.IDLE&&null!=ba?a!=l.BUFFERING&&ba!=a:!1}function K(a){var b=-1;return a.hasOwnProperty("ns_st_po")&&(b=j.getInteger(a.ns_st_po)),b}function L(a){var b=-1;return a.hasOwnProperty("ns_ts")&&(b=Number(a.ns_ts)),b}function M(a){return null!=a&&O()!=a}function N(a){Y=a,ja=+new Date}function O(){return Y}function P(a){X=a}function Q(){var a,b;1==arguments.length?(a=l.toEventType(Y),b=arguments[0]):(a=arguments[0],b=arguments[1]);var c={};if("undefined"!=typeof document){var d=document;c.c7=d.URL,c.c8=d.title,c.c9=d.referrer}return null!=b&&j.extend(c,b),c.hasOwnProperty("ns_ts")||(c.ns_ts=String(+new Date)),null!=a&&!c.hasOwnProperty("ns_st_ev")&&(c.ns_st_ev=k.toString(a)),ga.isPersistentLabelsShared()&&Z&&j.extend(c,Z.getLabels()),j.extend(c,ga.getLabels()),R(a,c),ma.createLabels(a,c),ma.getClip().createLabels(a,c),c.hasOwnProperty("ns_st_mp")||(c.ns_st_mp=ca),c.hasOwnProperty("ns_st_mv")||(c.ns_st_mv=da),c.hasOwnProperty("ns_st_ub")||(c.ns_st_ub="0"),c.hasOwnProperty("ns_st_br")||(c.ns_st_br="0"),c.hasOwnProperty("ns_st_pn")||(c.ns_st_pn="1"),c.hasOwnProperty("ns_st_tp")||(c.ns_st_tp="1"),c.hasOwnProperty("ns_st_it")||(c.ns_st_it="c"),c.ns_st_sv=n.STREAMSENSE_VERSION,c.ns_type="hidden",c}function R(a,b){var c=b||{};if(c.ns_st_ec=String(la),!c.hasOwnProperty("ns_st_po")){var d=ka,e=L(c);(a==k.PLAY||a==k.KEEP_ALIVE||a==k.HEART_BEAT||null==a&&Y==l.PLAYING)&&(d+=e-ma.getClip().getPlaybackTimestamp()),c.ns_st_po=j.getInteger(d)}return a==k.HEART_BEAT&&(c.ns_st_hc=String(ta)),c}function S(a){var b=L(a);0>b&&(a.ns_ts=String(+new Date))}function T(a,b,c){b=b||{},b.ns_st_ad=1,a>=k.AD_PLAY&&a<=k.AD_CLICK&&ga.notify(a,b,c)}function U(a,b){ga.notify(k.CUSTOM,a,b)}var V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga=this,ha=500,ia=null,ja=0,ka=0,la=0,ma=null,na=!0,oa=!0,pa=n.DEFAULT_HEARTBEAT_INTERVAL,qa=n.DEFAULT_KEEP_ALIVE_INTERVAL,ra=n.DEFAULT_PAUSED_ON_BUFFERING_INTERVAL,sa=0,ta=0,ua=0,va=!1,wa={};j.extend(this,{reset:function(a){ma.reset(a),ma.setPlaylistCounter(0),ma.setPlaylistId(+new Date+"_1"),ma.getClip().reset(a),null==a||a.isEmpty()?V={}:j.filterMap(V,a),la=1,ta=0,m(),o(),u(),x(),z(),Y=l.IDLE,X=null,ja=-1,ba=null,ca=n.DEFAULT_PLAYERNAME,da=n.STREAMSENSE_VERSION,ea=null},setPauseOnBufferingInterval:function(a){ra=a},getPauseOnBufferingInterval:function(){return ra},setKeepAliveInterval:function(a){qa=a},getKeepAliveInterval:function(){return qa},setHeartbeatIntervals:function(a){pa=a},notify:function(){var a,b,c,d;b=arguments[0],3==arguments.length?(c=arguments[1],d=arguments[2]):(c={},d=arguments[1]),a=A(b);var e=j.extend({},c);if(S(e),e.hasOwnProperty("ns_st_po")||(e.ns_st_po=j.getInteger(d)),b==k.PLAY||b==k.PAUSE||b==k.BUFFER||b==k.END){var f=+new Date-ja;ga.isPausePlaySwitchDelayEnabled()&&M(a)&&y(Y)&&y(a)&&ha>=f?B(a,e,ha):B(a,e)}else{var g=Q(b,e);j.extend(g,e),D(g,!1),la++}},getLabels:function(){return V},getState:function(){return Y},setLabels:function(a){null!=a&&(null==V?V=a:j.extend(V,a))},getLabel:function(a){return V[a]},setLabel:function(a,b){null==b?delete V[a]:V[a]=b},setPixelURL:function(a){if(null==a||0==a.length)return null;var b=decodeURIComponent||unescape,c=a.indexOf("?");if(c>=0){if(c<a.length-1){for(var d=a.substring(c+1).split("&"),e=0,f=d.length;f>e;e++){var g=d[e],h=g.split("=");2==h.length?ga.setLabel(h[0],b(h[1])):1==h.length&&ga.setLabel(n.PAGE_NAME_LABEL,b(h[0]))}a=a.substring(0,c+1)}}else a+="?";return ia=a},getPixelURL:function(){return ia?ia:"undefined"!=typeof ns_p&&"string"==typeof ns_p.src?ia=ns_p.src.replace(/&amp;/,"&").replace(/&ns__t=\d+/,""):"string"==typeof ns_pixelUrl?ia.replace(/&amp;/,"&").replace(/&ns__t=\d+/,""):null},isPersistentLabelsShared:function(){return na},setPersistentLabelsShared:function(a){na=a},isPauseOnBufferingEnabled:function(){return oa},setPauseOnBufferingEnabled:function(a){oa=a},isPausePlaySwitchDelayEnabled:function(){return va},setPausePlaySwitchDelayEnabled:function(a){va=a},setPausePlaySwitchDelay:function(a){a&&a>0&&(ha=a)},getPausePlaySwitchDelay:function(){return ha},setClip:function(a,b){var c=!1;return Y==l.IDLE&&(ma.getClip().reset(),ma.getClip().setLabels(a,null),b&&ma.incrementStarts(),c=!0),c},setPlaylist:function(a){var b=!1;return Y==l.IDLE&&(ma.incrementPlaylistCounter(),ma.reset(),ma.getClip().reset(),ma.setLabels(a,null),b=!0),b},importState:function(a){reset();var b=j.extend({},a);ma.setRegisters(b,null),ma.getClip().setRegisters(b,null),C(b),la++},exportState:function(){return ea},getVersion:function(){return n.STREAMSENSE_VERSION},addListener:function(a){fa.push(a)},removeListener:function(a){fa.splice(j.indexOf(a,fa),1)},getClip:function(){return ma.getClip()},getPlaylist:function(){return ma},setHttpGet:a,setHttpPost:b}),j.extend(this,{adNotify:T,customNotify:U,viewNotify:function(a,b){a=a||ga.getPixelURL(),a&&c(a,b)}}),J.comScore&&(wa=J.comScore.exports,Z=wa.c()),V={},la=1,Y=l.IDLE,ma=new p,$=null,oa=!0,aa=null,ta=0,o(),_=null,W=null,va=!1,ba=null,ka=0,fa=[],ga.reset(),f&&ga.setLabels(f),g&&ga.setPixelURL(g)};return function(a){function b(a,b){return w[y]||d(a,b)}function c(){y=-1;for(var a=0;x>=a;a++)if(w.hasOwnProperty(a)){y=a;break}return J.StreamSense.activeIndex=y,y}function d(a,b){return a=a||null,b=b||null,a&&"object"==typeof a&&(b=a,a=null),w[++x]=new J.StreamSense(b,a),c(),w[x]}function e(){var a=!1,b=y;if("number"==typeof arguments[0]&&isFinite(arguments[0]))b=arguments[0];else if(arguments[0]instanceof J.StreamSense)for(var d in w)if(w[d]===arguments[0]){b=d;break}return w.hasOwnProperty(b)&&(a=w[b],delete w[b],a.reset(),c()),a}function f(a){return a=a||{},b().setPlaylist(a),b().getPlaylist()}function g(a,c,d){return a=a||{},"number"==typeof c&&(a.ns_st_cn=c),b().setClip(a,d),b().getClip()}function h(a,c,d){return"undefined"==typeof a?!1:(d=d||null,c=c||{},b().notify(a,c,d))}function i(a){"undefined"!=typeof a&&b().setLabels(a)}function k(){return b().getLabels()}function l(a){"undefined"!=typeof a&&b().getPlaylist().setLabels(a)}function m(){return b().getPlaylist().getLabels()}function n(a){"undefined"!=typeof a&&b().getClip().setLabels(a)}function o(){return b().getClip().getLabels()}function p(a){return b().reset(a||{})}function q(a){return b().getPlaylist().reset(a||{})}function r(a){return b().getClip().reset(a||{})}function s(a){return a=a||{},b().viewNotify(null,a)}function t(a,c){return arguments.length>2&&(a=arguments[1],c=arguments[2]),a=a||{},"number"==typeof c&&(a.ns_st_po=c),b().customNotify(a,c)}function u(){return b().exportState()}function v(a){b().importState(a)}var w={},x=-1,y=-1;j.extend(a,{activeIndex:y,newInstance:d,"new":d,destroyInstance:e,destroy:e,newPlaylist:f,newClip:g,notify:h,setLabels:i,getLabels:k,setPlaylistLabels:l,getPlaylistLabels:m,setClipLabels:n,getClipLabels:o,resetInstance:p,resetPlaylist:q,resetClip:r,viewEvent:s,customEvent:t,exportState:u,importState:v})}(f),f}();return q.AdEvents=m,q.PlayerEvents=k,q}()}(),console.log("vmDtvLib fileLoader.js"),function(){"use strict";function a(a,g,h,i,j,k){var l=this;if(this.startTime=(new Date).getTime(),this.aborted=!1,this.xobj=new XMLHttpRequest,this.timerId=setTimeout(function(){e.debug("timeout",a);var c=!l.aborted;l.aborted=!0,l.xobj.abort(),c&&d.logCreateCall(b.FL_TIMEOUT,"Request timed out: "+a,e,h)},1e3*(j?j:f)),null!=i){var m=""+("boolean"==typeof i?(new Date).getTime():i);a=c.urlUtil.newUrl().setUrl(a).setQueryParameter("_",m).getUrl()}this.xobj.overrideMimeType("application/json"),this.xobj.open(k?"PUT":"GET",a,!0),this.xobj.onreadystatechange=function(){if(e.debug("onreadystatechange, status:"+l.xobj.status+" xobj.readyState:"+l.xobj.readyState+" aborted:"+l.aborted),!l.aborted&&4==l.xobj.readyState){if(clearTimeout(l.timerId),l.aborted=!0,"200"!=l.xobj.status){var c=((new Date).getTime()-l.startTime)/1e3;return void d.logCreateCall(b.FL_LOAD_ERR,"After "+c+"s. Http status "+l.xobj.status+"("+l.xobj.statusText+"), "+l.xobj.responseText+", failed to load "+a,e,h)}g&&g(l.xobj.responseText)}},this.xobj.send(k)}var b,c=window.vmDtvLib=window.vmDtvLib||{},d=c.error,e=c.logger.getInstance("vmDtvLib fileLoader"),f=240,g=[];c.fileLoader={FL_NO_URL:"NO_URL",FL_LOAD_ERR:"LOAD_ERR",FL_TIMEOUT:"TIMEOUT",loadFile:function(c,f,h,i,j,k){if(e.info("loadFile url:",c,"cacheTag",i),null==c||""===c)return void setTimeout(d.logCreateCall,0,[b.FL_NO_URL,"No url provided to loadFile call",e,h]);var l=g.indexOf(null);-1==l&&(l=g.length),g[l]=new a(c,function(a){g[l]=null,f&&f(a)},h,i,j,k)}},b=c.fileLoader}(),console.log("vmDtvLib jsonLoader.js"),function(){"use strict";function a(a,c,f){var g;try{g=JSON.parse(a)}catch(h){return void d.logCreateCall(b.JL_PARSE_ERR,h.message,e,function(b){f(b,a)})}c&&c(g)}var b,c=window.vmDtvLib=window.vmDtvLib||{},d=c.error,e=c.logger.getInstance("vmDtvLib jsonLoader"),f=240,g=f,h=0,i="vdlJsonp";c.jsonLoader={JL_NO_URL:c.fileLoader.FL_NO_URL,JL_PARSE_ERR:"PARSE_ERR",JL_LOAD_ERR:c.fileLoader.FL_LOAD_ERR,JL_TIMEOUT:c.fileLoader.FL_TIMEOUT,loadJson:function(b,d,f,g,h,i){e.info("loadJson url:",b,"cacheTag",g),c.fileLoader.loadFile(b,function(b){a(b,d,f)},f,g,h,i)},loadJsonp:function(a,f,j,k,l,m,n){function o(){e.debug("cleanUp"),q&&clearTimeout(q),r.removeChild(p),window[l]=function(){e.debug("dummy jsonpCbFuncName")},window.onerror=t,p.onerror=null}e.info("loadJson url:",a,"cacheTag",k);var p,q,r,s,t;return a?(h++,l||(m=m||"callback",l=i+h),(k||m)&&(s=c.urlUtil.newUrl().setUrl(a),k&&s.setQueryParameter("_"+(new Date).getTime(),""),m&&s.setQueryParameter(m,l),a=s.getUrl()),window[l]=function(c){e.debug(l,c),o(),c?f&&f(c):d.logCreateCall(b.JL_LOAD_ERR,"No Data, Failed to load "+a,e,j)},t=window.onerror,window.onerror=function(c,f,g){e.debug("window onerror","mess",c,"location",f,"row",g),f&&f!==a||(o(),d.logCreateCall(b.JL_PARSE_ERR,c+" In file: "+a,e,j))},p=document.createElement("script"),e.debug("making jsonp request",a),p.onerror=function(c){o(),d.logCreateCall(b.JL_LOAD_ERR,"Failed to load: "+a,e,j)},p.src=a,p.id=i+h,r=document.getElementsByTagName("head")[0]||document.documentElement,r.appendChild(p),void(q=setTimeout(function(){o(),d.logCreateCall(b.JL_TIMEOUT,"Request timed out: "+a,e,j)},1e3*(n?n:g)))):void setTimeout(d.logCreateCall,0,[b.JL_NO_URL,"No url provided to loadJsonp call",e,j])}},b=c.jsonLoader}(),console.log("vmDtvLib configLoader.js"),function(){"use strict";var a=window.vmDtvLib=window.vmDtvLib||{},b=a.logger.getInstance("vmDtvLib configLoader"),c="http://tivo-apps-vm.is.dtv/publishConfig/htmlApps",d="/publishConfig/devConfig.json",e=!1;a.configLoader={CL_BAD_URL_PARAM:"BAD_URL_PARAM",CL_ADD_PARAMS_ERR:"ADD_PARAMS_ERR",setNoConfigFile:function(){return e=!0,this},corretToBooleanType:function(a,b){return a="true"===a?!0:"false"===a?!1:a,"boolean"!==typeOf(a)&&(a=b),a},loadConfig:function(f,g,h){function i(c){var d=a.error,e=a.configLoader;null==h&&(h=location.search);try{var i=a.netUtil;i.iterateNvpStr(h.substr(1),function(a,d){try{b.log("adding param "+a,d);for(var e,f,g,h=a+":",i=c,j=!1,k=/([^\.\[\]]+)\]?([\.\[:])/g;null!==(e=k.exec(h));)j=!0,f=i[e[1]],g=typeOf(f),i="object"===g&&"."===e[2]||"array"===g&&"["===e[2]?f:i[e[1]]="["===e[2]?[]:"."===e[2]?{}:d;if(!j)throw"unexpected syntax"}catch(l){b.error("Error trying to add parameter "+a+" from Url to config. "+l)}})}catch(k){return void d.logCreateCall(e.CL_ADD_PARAMS_ERR,k,b,g)}if(j){var l=(new a.Url).setUrl(j).makeAbsolute(location.href);c.vmAbsConfigUrl=l.getUrl();var m=l.setFragment("").setQuery("").setFile("").getUrl();c.vmAbsConfigPath="/"===m.substr(-1,1)?m.substr(0,m.length-1):m}b.log("Config with url params",c),f(c)}var j,k,l="DEV"===a.buildEnvironment;if(!e){var m=a.netUtil,n=m.nvpStrToObj(location.search.substr(1));if(j=n.vmConfigUrl,l){if((null==j||""===j)&&(j=d,b.info("Setting configUrl to dev default: "+j),"/"===j.charAt(0)||"\\"===j.charAt(0))){var o=m.splitOnFirst(m.splitOnFirst(location.href,"#")[0],"?")[0];j=o.substring(0,o.lastIndexOf("/"))+j}}else!j||"/"!==j.charAt(0)&&"\\"!==j.charAt(0)||(j=c+j)}j?(k=(new a.Url).setUrl(j).getFileExtension().toLowerCase(),"js"===k||"jsonp"===k?a.jsonLoader.loadJsonp(j,i,g,!0,"jsonpCallback"):a.jsonLoader.loadJson(j,i,g,!0)):setTimeout(i,0,{})}}}(),console.log("vmDtvLib chanMan.js"),function(){"use strict";function a(a){return/^[0-9]+$/.test(a)}function b(a,b){try{if(G.debug("makeChanLstCb",null!=o,S),p&&(clearTimeout(p),p=null),o){if(a)setTimeout(o,0);else try{o(b)}catch(c){G.error("callback to useChanlist raised uncaught exception",c.name,c.message)}o=null,S=!1}}catch(c){o&&o(new F.error.VmError("UNEXP",c.name+", "+c.message))}}function c(){G.debug(E+"onChannelListUpdate"),m=n.channelList,G.debug("number channels",m.length),b()}function d(a){try{G.debug("tuneOnSelectedComponentChanged ",a.componentType),a.componentType===k.COMPONENT_TYPE_AUDIO&&Z()}catch(b){g(s,null,new F.error.VmError("UNEXP",b.name+", "+b.message))}}function e(){G.debug("onTuneTimeout"),g(s,null,new F.error.VmError("FAIL_TUNE","timedout waiting for channel to tune"))}function f(){k&&(k.removeEventListener("PlayStateChange",Y),k.removeEventListener("ChannelChangeError",ba),k.removeEventListener("ChannelChangeSucceeded",aa),k.removeEventListener("SelectedComponentChanged",d))}function g(a,b,c){function d(a){var b,c,d="";for(b=0;b<a.length;b++)c=a[b],b&&(d+=", "),d+=c.pid+(c.language?"("+c.language+")":"");return d}var e=!1;try{k&&G.debug("Audio components: "+d(k.getComponents(k.COMPONENT_TYPE_AUDIO)),"Active audio components: "+d(k.getCurrentActiveComponents(k.COMPONENT_TYPE_AUDIO)))}catch(g){}if(c&&G.error(c.type,c.message),v&&clearTimeout(v),v=null,u=!1,f(),q?(q=!1,e=!0):c&&(e=!0),r&&e){var h=r;r=null;try{G.info("Tune completed, making callback"),h(a,b,c)}catch(g){G.error("callback to tuneToChannel raised uncaught exception",g.name,g.message)}}}function h(a){G.debug(E+"onSelectedComponentChanged",a.componentType),a.componentType===y&&ga(y,z,A,!0)&&j(x)}function i(){G.debug("onComponentTimeout"),j(x,new F.error.VmError("FAIL_COMPONENT","timedout waiting for onSelectedComponentChanged event"))}function j(a,b){if(b&&G.error(b.type,b.message),B&&clearTimeout(B),B=null,k.removeEventListener("SelectedComponentChanged",h),x===a&&(x=null),a)try{a(b)}catch(c){G.error("callback passed to selectAudioComponent raised uncaught exception",c.name,c.message)}}var k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E="EVENT ++++++++++++++++  ",F=window.vmDtvLib=window.vmDtvLib||{},G=F.logger.getInstance("vmDtvLib chanMan"),H=6e4,I=60,J="x-tivo:classicui:livetv",K="OK",L="You are currently recording 3 Shows",M="Shows are recording on all your TiVo box tuners and it needs to change channel for a new recording.<p>If you want to continue to use this app you'll need to manage your recordings.<p>To exit press OK",N="Channel Unavailable",O="Unable to tune to the channel. Please try again later.",P=800,Q=6e4,R=6e4,S=!0,T=function(){};document.addEventListener("keydown",function(a){D&&C&&(C.onKey(a),a.stopImmediatePropagation())},!0);var U=function(a){if(G.debug("init","VERSION",l.VERSION),!k||a&&a!==k)if(a&&"VM-TIVO"===F.system.getDeviceType())k&&V(),k=a;else{if(!oipfObjectFactory.isObjectSupported("video/broadcast"))throw new F.error.VmError("NO_SUPPORT","video/broadcast object not supported");G.debug("creating videoBroadcastObject"),k=oipfObjectFactory.createVideoBroadcastObject()}else G.debug("using existing videoBroadcastObject");return k},V=function(){G.debug("release"),X(),v&&(clearTimeout(v),v=null,q=!1),B&&(clearTimeout(B),B=null),k&&(f(),k.release(),k.removeEventListener("SelectedComponentChanged",h))},W=function(a){function d(){b(!1,new F.error.VmError("NO_CHANLIST","no channel list avaialable"))}try{if(G.debug("useChanList"),o)return void b(!0,new F.error.VmError("CALL_IN_PROGRESS","existing useChanList call still in progress"));o=a,m?(G.debug("have previously obtained the channelList"),b(!0)):(k||U(),n=k.getChannelConfig(),m=n.channelList,!S||m.length>0?(G.debug("number channels",m.length),b(!0)):(p=setTimeout(d,Q),G.debug("waiting for channel list")),n.addEventListener("ChannelListUpdate",c))}catch(e){b(!0,new F.error.VmError("UNEXP",e.name+", "+e.message))}},X=function(){G.debug("stopUseChanList"),p&&(clearTimeout(p),p=null),n&&n.removeEventListener("ChannelListUpdate",c),m=n=null},Y=function(a){try{G.debug(E+"onPlayStateChange, state param:  "+l.playStateTxt[a.state]),void 0!==a.error?g(s,k.currentChannel,F.error.logAndCreate("FAIL_TUNE","failed to tune:"+a.error,G)):(a.state===l.PS_PRESENTING&&_(),Z())}catch(b){g(s,null,new F.error.VmError("UNEXP",b.name+", "+b.message))}},Z=function(){$()&&g(s,k.currentChannel)},$=function(){G.debug("isFullyTuned",t);var a=!1,b=k.currentChannel;if(b&&(!t||b.networkServiceId===t)){var c=k.playState,d=!1,e=A===l.AV_AS_IS||null!=ga(k.COMPONENT_TYPE_AUDIO,z,A,!0);a=c===l.PS_PRESENTING&&!d&&e,G.debug("chan name",b.name,"vb playstate: "+l.playStateTxt[c],"locked",d,"reqAudioActive",e)}return G.debug("fully tuned",a),a},_=function(){G.debug("tryRequestAudio","tuneRequestedAudio",u,z,A);var a;u||ga(k.COMPONENT_TYPE_AUDIO,z,A,!0)||(a=ga(k.COMPONENT_TYPE_AUDIO,z,A),a&&(G.debug("requesting audio",a.pid),k.addEventListener("SelectedComponentChanged",d),k.selectComponent(a),u=!0))},aa=function(a){try{G.debug(E+"onChannelChangeSucceeded"),a.channel&&G.debug("param chan:"+a.channel.name),Z()}catch(b){g(s,null,new F.error.VmError("UNEXP",b.name+", "+b.message))}},ba=function(a){try{G.debug(E+"onChannelChangeError, error:",a.errorState);var b=a.channel;b&&G.debug("param chan:"+b.name),b&&b.networkServiceId!==t&&(G.warn("onChannelChangeError, channel not that requested +++++++++++++++++++++++++++++++++++++++++++++++++++++++"),G.warn("parameter",b.name,b.networkServiceId,"requested chan",t)),g(s,b,new F.error.VmError("FAIL_TUNE","fail tune for: "+s+" error: "+a.errorState))}catch(c){g(s,null,new F.error.VmError("UNEXP",c.name+", "+c.message))}},ca=function(b,c,d,f){var h,i,j=function(){try{G.debug("doBind");var a=k.currentChannel;a&&k.playState===l.PS_PRESENTING?g(s,a):(null==z&&null==A&&(A=l.AV_AS_IS),v=setTimeout(e,H),k.addEventListener("PlayStateChange",Y),k.bindToCurrentChannel())}catch(b){g(s,null,new F.error.VmError("UNEXP",b.name+", "+b.message))}},n=function(a){try{G.debug("doTune");var b;if(a)return void g(s,null,a);b=null!=t?m.getChannelByNetworkServiceId(t):m.getChannelByName(h),b?b.received!==!0?g(s,null,new F.error.VmError("NOT_SUBSCRIBED","not subscribed to channel: "+b.name+", "+s)):(v=setTimeout(e,H),t=b.networkServiceId,k.addEventListener("ChannelChangeSucceeded",aa),k.addEventListener("ChannelChangeError",ba),k.addEventListener("PlayStateChange",Y),G.info("tuning to chan",b.name,b.networkServiceId),k.setChannel(b)):g(s,null,new F.error.VmError("NO_CHAN","no channel for : "+s))}catch(c){g(s,null,new F.error.VmError("UNEXP",c.name+", "+c.message))}};try{if(G.debug("tuneToChannel",b,d,f),q)return G.error("TUNE_IN_PROGRESS","already tuning"),void(c&&c(b,null,new F.error.VmError("TUNE_IN_PROGRESS","already tuning")));r=c,k||U(),t=null,u=!1,q=!0,s=b,z=d,A=f,"hasNoAudio"===A&&(A=l.AV_AS_IS),i=k.currentChannel,null==s?j():(a(s)?t=Number(s):h=String(s),i&&(null!=t&&i.networkServiceId===t||h&&i.name===h)?j():m?n():W(n)),i=null}catch(o){g(b,null,new F.error.VmError("UNEXP",o.name+", "+o.message))}},da=function(a,b,c){return G.debug("selectAudioComponent",a,b),b||(b="language"),null==a&&(a="eng"),ea(k.COMPONENT_TYPE_AUDIO,a,b,c)},ea=function(a,b,c,d){try{B&&j(x,new F.error.VmError("SELECT_CANCELLED",""+y+":"+z+":"+A+": request for new component made"));var e;if(x=d,e=ga(a,b,c),!e)return void j(d,new F.error.VmError("NO_COMPONENT","No component "+c+"="+b));d&&(B=setTimeout(i,R),k.addEventListener("SelectedComponentChanged",h),y=a,z=b,A=c),G.debug("selecting component with pid",e.pid),k.selectComponent(e)}catch(f){j(d,new F.error.VmError("UNEXP",f.name+", "+f.message))}},fa=function(a,b,c){return G.debug("getAudioComponent",a,b),ga(k.COMPONENT_TYPE_AUDIO,a,b,c)},ga=function(a,b,c,d){a===k.COMPONENT_TYPE_AUDIO&&(c||(c="language"),null==b&&(b="eng"));var e=d?k.getCurrentActiveComponents(a):k.getComponents(a);if(d&&"index"===c){c="pid";var f=k.getComponents(a);if(b=f&&f[b]?f[b].pid:null,null==b)return null}var g,h;for(b=String(b),g=0;g<e.length;g++)if(h=String("index"===c?g:e[g][c]),b===h){G.debug("getAvComponent, requested component:"),ma(e[g]);var i=e.item(g);return i}return G.debug("getAvComponent requested component not found",a,b,c,d),null},ha=function(b,c,d,e,f){var g,h,i=function(){try{G.debug("exitApp");var a=!1;D&&clearTimeout(D),D=null,d&&(a=h?d(new F.error.VmError("UNEXP",h.name+", "+h.message)):d()),a||ia()}catch(b){ia()}},j=function(a){try{G.debug("announceAndExitApp"),C||(k.stop(),k.release(),D=setTimeout(i,1e3*I),(C=new F.OptionPopup).init({id:"vdl_CmExitPopup",width:P,title:a?N:L,body:a?O:M,buttons:[{text:K,id:"OK"
}]}).centre().addListener("CANCEL",i).addListener("OK",i).show())}catch(b){h=b,i()}},m=function(b){return null==g?!1:a(g)&&Number(g)==b.networkServiceId||String(g)===b.name},n=function(a){try{if(G.debug(E+"onTunerConflict",l.tunerEventTypeTxt[a.tunerEventType]+"("+a.tunerEventType+")","requestedChanId",g),a.tunerEventType===l.TE_CONFLICT&&a.tunerConflictEvent)for(var b=a.tunerConflictEvent,c=0;c<b.defaultCancelledTunerTasks.length;c++){var d=b.tunerTasks[b.defaultCancelledTunerTasks[c]];d&&d.channel&&(G.debug("cancel channel",d.channel.name,d.channel.networkServiceId,l.tunerIdTypeTxt[d.tunerIdentifierType],l.tunerTaskTypeTxt[d.tunerTaskType]),m(d.channel)&&j())}}catch(e){G.error("exception onTunerConflict",e),h=e,j()}},o=function(a,b,d){try{G.debug("tuneCb"),d?(G.error("tuneCb error",d),j(d)):(b&&(g=b.networkServiceId),c&&c(a,b))}catch(e){G.error("tuneCb exception",e),h=e,j(!0)}};G.debug("tuneAndExitOnTunerLoss",b,e,f),D||C?G.warn("App already exiting, tune request ignored"):(g=b,c||(c=T),d||(d=T),k||U(),k.addEventListener("TunerConflict",n),w&&k.removeEventListener("TunerConflict",w),w=n,ca(b,o,e,f))},ia=function(){V(),tivo.core.exit()},ja=function(b,c,d){var e,f=function(){if(G.debug("findChanAndNavTv"),e=a(b)?m.getChannelByNetworkServiceId(Number(b)):m.getChannelByName(b)){var f='{"initialChannel":[{"channelNumber":["'+e.majorChannel+'"],"type":["channelIdentifier"],"sourceType":["cable"]}]}';c&&c(),V(),G.debug("replace app",d,J,f),F.tivoClient.getAction().uiNavigate(J,f,d)}else F.error.logCreateCall("NO_CHAN","no channel"+b,G,c)};G.debug("exitToTv, chanId: "+b),k||U(),null==d&&(d=!1),null==b&&k.currentChannel&&(b=k.currentChannel.networkServiceId),null==b?F.error.logCreateCall("INVALID_CHANID","no current channel",G,c):m?f():W(f)},ka=function(a,b,c){var d,e=c.split(",");if(G.debug("print "+b+"object"),a)for(var f=0;f<e.length;f++)d=e[f].trim(),G.debug(d,a[d])},la=function(a){a&&ka(a,"Channel","channelType, ccid, onid, tsid, sid, name, majorChannel, minorChannel, stationId, favourite, manualBlock, hidden, networkServiceId, received")},ma=function(a){a&&ka(a,"AVAudioComponent","componentTag, pid, type, encoding, encrypted, language, audioDescription, audioChannels")},na=function(a){var b;if(a){a.channel&&G.debug("channel - name",a.channel.name),ka(a,"Programme","ID_TVA_CRID, ID_DVB_EVENT, name, description, channelID, programmeID, duration, programmeIDType");var c=new Date(Number(1e3*a.startTime));if(G.debug("startTime",a.startTime,c.toString()),a.parentalRatings&&a.parentalRatings.length>0)for(b=0;b<a.parentalRatings.length;b++)G.debug("rating "+b+"1 of "+a.parentalRatings.length),oa(a.parentalRatings[b]);else G.debug("Has no ratings")}},oa=function(a){a&&(ka(a,"ParentalRating","name, scheme, value, region"),G.debug("labels",a.labels,a.labels?a.labels.toString(2):""))};l=F.chanMan={PS_UNREALIZED:0,PS_CONNECTING:1,PS_PRESENTING:2,PS_STOPPED:3,TE_CONFLICT:0,TE_RESOLUTION:1,TT_FOREGROUND:2,TT_BACKGROUND:1,AV_AS_IS:"LEAVE_AS_IS",playStateTxt:["UNREALIZED","CONNECTING","PRESENTING","STOPPED"],tunerEventTypeTxt:["CONFLICT","RESOLUTION"],tunerIdTypeTxt:[null,"BACKGROUND","FOREGROUND"],tunerTaskTypeTxt:[null,"BUFFERING","CHANGE_CHANNEL","RECORDING","RESERVED","SCHEDULED_RECORDING"],init:U,release:V,useChanList:W,stopUseChanList:X,tuneToChannel:ca,selectAudioComponent:da,getAudioComponent:fa,tuneAndExitOnTunerLoss:ha,exitToTv:ja,exitAppNow:ia,printChannel:la,printComponent:ma,printProgramme:na,printParentalRating:oa,VERSION:"1.2.0"},Object.defineProperty(l,"channelConfig",{get:function(){return n}}),Object.defineProperty(l,"channelList",{get:function(){return m}}),Object.defineProperty(l,"videoBroadcast",{get:function(){return k}}),F.lib.configComponentsCb.chMan=function(a){G.debug("chanMan config"),R=a.waitComponentMs||R,Q=a.waitChanlistMs||Q,H=a.waitTuneMs||H,I=a.waitExitS||I,J=a.tvUri||J,K=a.exitButText||K,L=a.exitTitle||L,M=a.exitText||M,P=a.exitWidthPx||P,N=a.exitErrorTitle||N,O=a.exitErrorText||O},G.log("VERSION",l.VERSION)}(),function(){"use strict";var a=window.vmDtvLib=window.vmDtvLib||{},b=a.logger.getInstance("vmDtvLib vodUtil"),c=function(a,c){b.debug(a,c);var d,e;switch(a=a.toUpperCase()){case"U":case"UC":case"PG":return!1;case"12":case"12A":e=new Date(c.getTime()),e.setHours(20,0,0,0);break;case"15":case"G":e=new Date(c.getTime()),e.setHours(21,0,0,0);break;case"ADULT":return!0;default:e=new Date(c.getTime()),e.setHours(22,0,0,0)}return d=new Date(c.getTime()),d.setHours(5,30,0,0),c>d||e>c},d=function(b,c,d,e){var f="";d&&(f=" for "+a.dateTime.toDaysHoursMinutes(d*a.dateTime.millisInMinute));var g=new a.ThumbConfirm;g.init(function(a){document.removeEventListener("keydown",g.onKey),g=null,b(a)},"Confirm Rental","Press THUMBS UP to confirm that you want to rent "+c+f+(e?" for £"+e:"")+".","Press [THUMB] to rent and watch","Never mind, don't rent this show"),document.addEventListener("keydown",g.onKey,!1)},e=function(b,c,d,e){var f="";d&&(f=" for "+a.dateTime.toDaysHoursMinutes(d*a.dateTime.millisInMinute));var g=new a.PinPrompt;g.init(function(a){document.removeEventListener("keydown",g.onKey),g=null,b(a)},{instructionEnter:"Enter your PIN to rent "+c+f+(e?" for £"+e:"")+"."}),document.addEventListener("keydown",g.onKey,!1)};a.vodUtil={isPinRequired:c,thumbConfirm:d,vodPin:e}}(),console.log("vmDtvLib traxis.js"),function(){"use strict";function a(a,c,d,e){j.info("getCategoryByCrid",a,e),l?c(i.clone(m[l].getCategory)):i.jsonLoader.loadJson(q,function(a){var f;try{f=a.Categories.Category[0]}catch(g){return void i.error.logCreateCall(o,"Adrenaline return data malformed",j,d)}null==e||null==f?c(f):b(f,e,0,function(a){f.Children=a,c(f)},d)},d,null,null,r.supplant({CRID:a}))}function b(a,b,c,d,e){function f(a,b,c){i.jsonLoader.loadJson(q,c,e,null,null,s.supplant({CRID:k,LIMIT:a,OFFSET:b}))}function g(a,b,c){i.jsonLoader.loadJson(q,c,e,null,null,t.supplant({CRID:k,LIMIT:a,OFFSET:b}))}function h(b,c){null==b&&(b={Titles:{resultCount:a.TitleCount,Title:[]}}),null==c&&(c={Categories:{resultCount:a.ChildCategoryCount,Category:[]}});var f;try{f={Children:{resultCount:b.Titles.resultCount+c.Categories.resultCount,returnedCount:b.Titles.Title.length+c.Categories.Category.length,Title:b.Titles.Title,Category:c.Categories.Category}}}catch(g){return void i.error.logCreateCall(o,"Adrenaline return data malformed",j,e)}d(f)}if(j.info("getChildrenByCategory",a?a.id:null,b,c),l)d(i.clone(m[l].getChildren));else if(null==a)i.error.logCreateCall(n,"Mandatory parameter 'category' not supplied.",j,e);else if(null==b)i.error.logCreateCall(n,"Mandatory parameter 'limit' not supplied.",j,e);else{var k=a.id;c=null==c?0:c;var p=c>=a.TitleCount;p?0===a.ChildCategoryCount?h(null,null):g(b,c-a.TitleCount,function(a){h(null,a)}):f(b,c,function(c){var d,f;try{d=c.Titles.Title.length,f=a.ChildCategoryCount}catch(k){return void i.error.logCreateCall(o,"Adrenaline return data malformed",j,e)}0===f||d===b?h(c,null):g(b-d,0,function(a){h(c,a)})})}}function c(a,b,c){j.info("getTitleDetailByCrid",a),l?b(i.clone(m[l].getTitle)):null==a?i.error.logCreateCall(n,"Mandatory parameter 'crid' not supplied.",j,c):i.jsonLoader.loadJson(q,function(a){var d;try{d=a.Titles.Title[0]}catch(e){return void i.error.logCreateCall(o,"Adrenaline return data malformed",j,c)}b(d)},c,null,null,u.supplant({CRID:a}))}function d(a,b,d){j.info("getTitleDetailByTitle",a?a.id:null),null==a?i.error.logCreateCall(n,"Mandatory parameter 'title' not supplied.",j,d):c(a.id,b,d)}function e(a,b){j.info("playTitleByCrid",a),null==a?i.error.logCreateCall(n,"Mandatory parameter 'crid' not supplied.",j,b):c(a,function(c){null==c?i.error.logCreateCall(p,"No title with CRID:"+a,j,b):f(c,b)},b)}function f(a,b){if(j.info("playTitleByTitle",a?a.id:null),null==a)i.error.logCreateCall(n,"Mandatory parameter 'title' not supplied.",j,b);else{var c;try{c=a.Contents.Content[0]}catch(d){return void i.error.logCreateCall(o,"Adrenaline data passed in malformed",j,b)}if(c.Products){var f;try{f=c.Products.Product[0]}catch(d){return void i.error.logCreateCall(o,"Adrenaline data passed in malformed",j,b)}var g="x-tivo:flash:tivo_hdui?screenName=vod&partnerOfferId=c="+c.id+"#p="+f.id;i.tivoClient.getAction().uiNavigate(g,"{}")}else e(a.id,b)}}function g(a,b,d){j.info("playTitleByCridOrLinkToCategoryByPath",a,b),null==a?i.error.logCreateCall(n,"Mandatory parameter 'titleCrid' not supplied.",j,d):null==b?i.error.logCreateCall(n,"Mandatory parameter 'categoryPath' not supplied.",j,d):c(a,function(a){null==a?h(b,d):f(a,d)},function(){h(b,d)})}function h(a,b){j.info("linkToCategoryByPath",a),null==a?i.error.logCreateCall(n,"Mandatory parameter 'path' not supplied.",j,b):i.tivoClient.getAction().uiNavigate("x-tivo:flash:tivo_hdui?screenName=vod&entryPoint="+a,"{}")}var i=window.vmDtvLib=window.vmDtvLib||{},j=i.logger.getInstance("vmDtvLib traxis"),k=i.tivo.getMacAddress("DOCSIS");"DEV"===i.buildEnvironment&&""===k&&(k="3C:62:00:00:08:CD");var l,m=i.traxisSpoofData,n="TX_MISSING_PARAM",o="TX_DATA_MALFORMED",p="TX_NO_TITLE",q="https://adrenalin.anywhere.msp.dtv.virginmedia.com:8443/traxis/web?Output=json",r="<?xml version='1.0' encoding='utf-8'?><Request xmlns='urn:eventis:traxisweb:1.0'><Identity><CpeId>{CPEID}</CpeId></Identity><ResourcesQuery resourceType='Category'><ResourceIds><ResourceId>{CRID}</ResourceId></ResourceIds><Options><Option type='Props'>Name,ChildCategoryCount,TitleCount,isAdult</Option></Options></ResourcesQuery></Request>".supplant({CPEID:k}),s="<?xml version='1.0' encoding='utf-8'?><Request xmlns='urn:eventis:traxisweb:1.0'><Identity><CpeId>{CPEID}</CpeId></Identity><RelationQuery resourceType='Category' relationName='Titles' resourceId='{CRID}'><Options><Option type='Props'>Name,MediumSynopsis,Ratings,Duration,ContentProviderId,ProductionDate</Option><Option type='paging'>{OFFSET},{LIMIT}</Option></Options><SubQueries><SubQuery relationName='Contents'><Options><Option type='Props'>EntitlementState</Option></Options></SubQuery></SubQueries></RelationQuery></Request>".supplant({CPEID:k}),t="<?xml version='1.0' encoding='utf-8'?><Request xmlns='urn:eventis:traxisweb:1.0'><Identity><CpeId>{CPEID}</CpeId></Identity><RelationQuery resourceType='Category' relationName='ChildCategories' resourceId='{CRID}'><Options><Option type='Props'>Name,ChildCategoryCount,TitleCount,isAdult,ClientRenderType</Option><Option type='paging'>{OFFSET},{LIMIT}</Option></Options></RelationQuery></Request>".supplant({CPEID:k}),u="<?xml version='1.0' encoding='utf-8'?><Request xmlns='urn:eventis:traxisweb:1.0'><Identity><CpeId>{CPEID}</CpeId></Identity><ResourcesQuery resourceType='Title'><ResourceIds><ResourceId>{CRID}</ResourceId></ResourceIds><Options><Option type='Propset'>All</Option></Options><SubQueries><SubQuery relationName='Contents'><Options><Option type='Props'>EntitlementState,Products</Option></Options><SubQueries><SubQuery relationName='Products'><Options><Option type='Props'></Option></Options></SubQuery></SubQueries></SubQuery></SubQueries></ResourcesQuery></Request>".supplant({CPEID:k});i.lib.configComponentsCb.traxis=function(a){j.debug("traxis config",a),a.traxisUrl&&(q=a.traxisUrl+"/traxis/web?Output=json"),a.spoofType&&(l=a.spoofType),a.categoryRequestXML&&(r=a.categoryRequestXML.supplant({CPEID:k})),a.childTitlesXML&&(s=a.childTitlesXML.supplant({CPEID:k})),a.childCategoriesXML&&(t=a.childCategoriesXML.supplant({CPEID:k})),a.getDetailOfTitleXML&&(u=a.getDetailOfTitleXML.supplant({CPEID:k}))},i.traxis={TX_MISSING_PARAM:n,TX_DATA_MALFORMED:o,TX_NO_TITLE:p,getCategoryByCrid:a,getChildrenByCategory:b,getTitleDetailByCrid:c,getTitleDetailByTitle:d,playTitleByCrid:e,playTitleByTitle:f,playTitleByCridOrLinkToCategoryByPath:g,linkToCategoryByPath:h,VERSION:"1.0.0"},j.log("VERSION",i.traxis.VERSION)}(),console.log("vmDtvLib appHistory.js"),function(){"use strict";function a(){return String((new Date).getTime()).slice(0,-3)}function b(){return/BACK|RETURN/.test(o.tivoClient.getDevice().getNavigationDirection())}function c(){n=x.typ,i="1"==n||"3"==n||!w&&b(),u="2"==n||"3"==n,k=x.gtwy||k,m=x.gTm||m,j=d(x.prv)||j,x=null}function d(a){if(a){var b="string"==typeof a?o.urlUtil.newUrl().setUrl(a):a;return"*"===b.getQueryParameter("vdl.nav.gtwy")&&b.setQueryParameter("vdl.nav.gtwy",k).setQueryParameter("vdl.nav.gTm",m),b.getUrl()}return""}function e(a,b){return p.debug("enter"),v=a?a:r,v===t&&(v=s),l=b?b:location.href,null==i&&c(),i}function f(){p.debug("exitBack");var b=o.urlUtil.newUrl();if(!u&&k&&a()-m>y)b.setUrl(k);else{if(!j)return void window.tivo.core.exit();b.setUrl(j)}b.setQueryParameter("vdl.nav.typ","2"==b.getQueryParameter("vdl.nav.typ")?"3":"1"),window.location.assign(b.getUrl())}function g(c){if(p.debug("exitToApp"+c),!c)throw new o.error.VmError("NO_URL","exitToApp must have a url parameter");var d=o.urlUtil.newUrl().setUrl(c);v===q?(p.debug((new Date).getTime(),a()),d.setQueryParameter("vdl.nav.gTm",a()).setQueryParameter("vdl.nav.gtwy",l).setQueryParameter("vdl.nav.typ","2"),!w&&b()&&d.setQueryParameter("vdl.nav.typ","3")):k&&(d.setQueryParameter("vdl.nav.gtwy",k),m&&d.setQueryParameter("vdl.nav.gTm",m));var e=l;if((v===s||v===q)&&(e=j,u&&d.setQueryParameter("vdl.nav.typ","2")),e){var f=o.urlUtil.newUrl().setUrl(e),g=d.getQueryParameter("vdl.nav.gtwy");null!=g&&g===f.getQueryParameter("vdl.nav.gtwy")&&(e=f.setQueryParameter("vdl.nav.gtwy","*").removeQueryParameter("vdl.nav.gTm").getUrl()),d.setQueryParameter("vdl.nav.prv",e)}window.location.assign(d.getUrl())}function h(){return i}var i,j,k,l,m,n,o=window.vmDtvLib=window.vmDtvLib||{},p=o.logger.getInstance("vmDtvLib appHistory"),q="AT_GATEWAY",r="AT_NORMAL",s="AT_HIDDEN",t="AT_LAUNCHER",u=!1,v=r,w=!1,x={},y=600;o.lib.configComponentsCb.nav=function(a){p.debug("appHistory config"),w=!0,null!=a.sTm&&(y=Number(a.sTm),p.info("setting sessing time to",y),delete a.sTm,w=isEmpty(a)),x=a},o.appHistory={APP_HISTORY_VERSION:"1.0.0",AT_GATEWAY:q,AT_LAUNCHER:t,AT_NORMAL:r,AT_HIDDEN:s,enter:e,exitBack:f,exitToApp:g,getNavBack:h}}(),console.log("vmDtvLib popup.js"),function(){"use strict";var a=window.vmDtvLib=window.vmDtvLib||{},b=a.logger.getInstance("vmDtvLib popup");a.Popup=function(){function a(a){if(!j){j=document.createElement("div"),j.className="vdl_PopupContainer";var b=document.body;k=document.createElement("div"),k.className="vdl_PopupAlignmentContainer",l=document.createElement("div"),l.className="vdl_PopupContent",k.appendChild(l),a.id&&(j.id=a.id),j.appendChild(k),b.appendChild(j),null!=a.alpha&&h(a.alpha),null!=a.height&&(l.style.height=String(a.height)+"px"),null!=a.width&&(l.style.width=String(a.width)+"px"),null!=a.top&&(l.style.top=String(a.top)+"px"),null!=a.left&&(l.style.left=String(a.left)+"px"),d()}return this}function c(){j&&j.classList.remove("vdl_hide"),m=!0}function d(){j&&j.classList.add("vdl_hide"),m=!1}function e(){return m}function f(){return l}function g(){return b.debug("centre, width:",l.offsetWidth,"height:",l.offsetHeight),l&&(l.style.top=String(-(.5*Number(l.offsetHeight)))+"px",l.style.left=String(-(.5*Number(l.offsetWidth)))+"px"),this}function h(a){if(b.debug("setAlpha",a),l){var c=window.getComputedStyle(l).backgroundColor;l.style.backgroundColor=c.substring(0,c.lastIndexOf(",")+1)+a+")"}return this}function i(){if(j){var a=document.getElementsByTagName("body")[0];a.removeChild(j),m=!1,j=null,k=null,l=null}}var j,k,l,m=!1;this.init=a,this.show=c,this.hide=d,this.getVisible=e,this.getPopupHtmlElement=f,this.centre=g,this.setAlpha=h,this.deletePopup=i}}(),console.log("vmDtvLib basicPopup.js"),function(){"use strict";function a(){function a(a){var b=this.getPopupHtmlElement();if(!b){if(e.call(this,a),b=this.getPopupHtmlElement(),b.classList.add("vdl_BasicPopupContent"),a.title){var c=document.createElement("div");c.className="vdl_PopupTitle",c.appendChild(document.createTextNode(a.title)),b.appendChild(c)}var d=a.body;if(d){var f=document.createElement("div");f.className="vdl_PopupBody",f.innerHTML=d,b.appendChild(f)}}return this}function c(a){var b=this.getPopupHtmlElement();return b&&(b.getElementsByClassName("vdl_PopupTitle")[0].textContent=a),this}function d(a){var b=this.getPopupHtmlElement();return b&&(b.getElementsByClassName("vdl_PopupBody")[0].innerHTML=a),this}var e;b.Popup.call(this),e=this.init,this.init=a,this.setTitle=c,this.setBody=d}var b=window.vmDtvLib=window.vmDtvLib||{};a.prototype=Object.create(b.Popup.prototype),b.BasicPopup=a}(),console.log("vmDtvLib optionPopup.js"),function(){"use strict";function a(){function a(a){var b=this.getPopupHtmlElement();if(!b){if(t.call(this,a),b=this.getPopupHtmlElement(),b.classList.add("vdl_OptionPopupContent"),a.disableSound&&a.disableSound===!0&&e(!0),y=a.disableExit,a.buttons&&a.buttons.length>0){var c,d=a.buttons.length,l=document.createElement("div");l.className="vdl_PopupButtonsList";for(var m=0;d>m;m++)c=j(a.buttons[m]),c.style.top=""+(m*g-h)+"px",u.push(c),l.appendChild(c),a.idInitialFocus&&a.buttons[m].id===a.idInitialFocus&&(w=m,k(m));if(a.idInitialFocus||(w=0,k(0)),b.appendChild(l),l.style.height=""+g*d+"px",a.height){l.style.position="absolute",l.style.bottom=""+i+"px";var n=b.getElementsByClassName("vdl_PopupBody")[0];n.style.height=""+(l.offsetTop-n.offsetTop-f)+"px",n.style.overflow="hidden"}}x="use"}return this}function j(a){var b=document.createElement("div");b.className="vdl_PopupButton",b.setAttribute("buttonId",a.id);var c=document.createElement("span");c.innerHTML=a.text,c.className="vdl_PopupButtonText",b.appendChild(c);var d=document.createElement("div");d.className="vdl_PopupButtonLeftHint",b.appendChild(d);var e=document.createElement("div");e.className="vdl_PopupButtonRightHint",b.appendChild(e);var f=document.createElement("div");return f.className="vdl_PopupButtonCheck",b.appendChild(f),b}function k(a){return c.debug("setFocusTo",a,v),a>=0&&a<u.length&&!u[a].classList.contains("focused")?(d("UP_DOWN"),u[v]&&u[v].classList.remove("focused"),setTimeout(function(){u[a].classList.add("focused")},0),v=a,!0):(d("BONK"),!1)}function l(){return k(v+1)}function m(){return k(v-1)}function n(){if(c.debug("onFocusedButtonSelected"),v>=0){var a=u[v],b=a.getElementsByClassName("vdl_PopupButtonCheck")[0];a.getElementsByClassName("vdl_PopupButtonLeftHint")[0];b.style.opacity=1,setTimeout(function(){b.style.opacity=0;var c=a.getAttribute("buttonId"),d=new CustomEvent(c,{detail:{},bubbles:!0,cancelable:!0});a.dispatchEvent(d)},1e3)}}function o(a){var c=a.keyCode;if(s.getVisible()){if("use"!=x)return void d("BONK");var e=b.keyCodes;switch(c){case e.LEFT:case e.BACK:if(!y&&v>=0){d("UP_DOWN");var f=new CustomEvent("CANCEL",{detail:{},bubbles:!0,cancelable:!0});u[v].dispatchEvent(f),x="exit"}break;case e.UP:m();break;case e.DOWN:l();break;case e.SKIPFORWARD:u.length<1?d("BONK"):k(v==u.length-1?0:u.length-1);break;case e.CHANNELUP:k(0);break;case e.CHANNELDOWN:k(u.length-1);break;case e.RIGHT:case e.OK:d(c===e.OK?"SELECT":"UP_DOWN"),x="exit",n();break;default:d("BONK")}}}function p(a,b){var d=this.getPopupHtmlElement();return d&&(c.debug("addingeventListener",a),d.addEventListener(a,b)),this}function q(){return x="init",w>=0&&k(w),r(),this}function r(){return x="use",this}var s,t,u=[],v=-1,w=-1,x="init",y=!1;c.debug("Constructor, OptionPopup Version: "+b.OptionPopup.VERSION),b.BasicPopup.call(this),t=this.init,s=this,this.init=a,this.incrementFocus=l,this.decrementFocus=m,this.setFocusTo=k,this.onFocusedButtonSelected=n,this.onKey=o,this.addListener=p,this.reset=q}var b=window.vmDtvLib=window.vmDtvLib||{},c=b.logger.getInstance("vmDtvLib optionPopup"),d=b.sound,e=b.disableSound,f=30,g=44,h=13,i=4;a.prototype=Object.create(b.BasicPopup.prototype),a.VERSION="1.1.0",b.OptionPopup=a}(),function(){"use strict";function a(){e.debug("Constructor, PIN Version: "+this.PIN_VERSION),this.keysEntered=[],this.currentIndex=0,this.entryFields=[],this.validatingPin=!1,this.soundsEnabled=!0,this.resultCallBackFunc=null,this.pinEntryPopup=null,this.pinOptionPopup=null,this.failedAttempts=0,this.onKey=c.bind(this),this.opaque=!1,this.tivoDevice=null,this.lastPage=""}function b(a,b){b.PIN_TITLE_ENTER=a.titleEnter||f.PIN_TITLE_ENTER,b.PIN_TITLE_INCORRECT=a.titleIncorrect||f.PIN_TITLE_INCORRECT,b.INSTRUCTION_ENTER=a.instructionEnter||f.INSTRUCTION_ENTER,b.INSTRUCTION_INCORRECT=a.instructionIncorrect||f.INSTRUCTION_INCORRECT,b.INSTRUCTION_INCORRECT_OPTIONS=a.instructionIncorrectOptions||f.INSTRUCTION_INCORRECT_OPTIONS,b.BUTTON_CAPTION_RESET=a.buttonCaptionReset||f.BUTTON_CAPTION_RESET,b.BUTTON_CAPTION_AGAIN=a.buttonCaptionAgain||f.BUTTON_CAPTION_AGAIN,b.NO_HELP_LINK=d.configLoader.corretToBooleanType(a.noHelpLink,f.NO_HELP_LINK),b.LEFT_POS=Number(a.leftPos||f.LEFT_POS),b.TOP_POS=Number(a.topPos||f.TOP_POS)}function c(a){var b=a.keyCode,c=d.keyCodes;if(e.debug("onKey: key: "+b),this.pinOptionPopup&&this.pinOptionPopup.getVisible())this.pinOptionPopup.onKey(a);else if(!this.validatingPin)switch(b){case c.LEFT:this.playSound("UP_DOWN"),this.currentIndex>0?this.setCurrentActiveEntry(--this.currentIndex):this.cancelPin();break;case c.BACK:this.setCurrentActiveEntry(0),this.playSound("UP_DOWN"),this.cancelPin();break;case c.NUM0:case c.NUM1:case c.NUM2:case c.NUM3:case c.NUM4:case c.NUM5:case c.NUM6:case c.NUM7:case c.NUM8:case c.NUM9:this.addToKeys(b-c.NUM0),this.playSound("UP_DOWN");break;default:this.playSound("BONK")}}var d=window.vmDtvLib=window.vmDtvLib||{},e=d.logger.getInstance("vmDtvLib PinPrompt"),f=a.prototype;f.PIN_VERSION="1.3.0",f.DAX_NAME="pin_prompt",f.DAX_PAGE_ENTRY="pin-entry",f.DAX_PAGE_INCORRECT="pin-incorrect",f.DAX_PAGE_OPTIONS="pin-options",f.DAX_RESULT_SUCCESS="pin-success",f.DAX_RESULT_FAIL="pin-fail",f.DAX_RESET_PIN_LABEL="reset-pin-button",f.DAX_TRY_AGAIN_LABEL="try-again-button",f.NO_HELP_LINK=!1,f.HELP_LINK_URL="http://tivo-apps-vm.is.dtv/htmlApps/help/default/help.html?help.appConfig.pageToLoad.view=plugin&help.appConfig.pageToLoad.name=tv-care-pin-button&help.appConfig.linkSource=pinprompt",f.PIN_TITLE_ENTER="Enter PIN",f.PIN_TITLE_INCORRECT="Incorrect PIN",f.INSTRUCTION_ENTER="To continue, enter your PIN.",f.INSTRUCTION_INCORRECT="Your have entered an incorrect PIN. Please try again or press LEFT to go back.",f.INSTRUCTION_INCORRECT_OPTIONS='You have entered an incorrect PIN. If you\'ve forgotten your PIN, select "Reset the PIN" or press LEFT to go back.',f.BUTTON_CAPTION_RESET="Reset the PIN",f.BUTTON_CAPTION_AGAIN="Try again",f.MAX_ATTEMPTS=5,f.PIN_LENGTH=4,f.PIN_WIDTH=670,f.PIN_HEIGHT=430,f.LEFT_POS=null,f.TOP_POS=null,f.playSound=d.sound,f.disableSound=d.disableSound,d.PinPrompt=a,d.lib.configComponentsCb.pin=function(a){console.log("=== PinPrompt : PIN Config"),f.HELP_LINK_URL=a.helpLinkUrl||f.HELP_LINK_URL,f.MAX_ATTEMPTS=Number(a.maxAttempts||f.MAX_ATTEMPTS),b(a,f)},f.setOpaque=function(a){return e.debug("setOpaque: "+a),this.opaque=a,this},f.disableSounds=function(a){return e.debug("disableSounds: "+a),this.soundsEnabled=!a,a&&a===!0&&this.disableSound(!0),this},f.setPosition=function(a,b){return e.debug("setPosition: left,top: "+a,b),this.LEFT_POS=a,this.TOP_POS=b,this},f.init=function(a,c){return e.debug("init"),a?(this.resultCallBackFunc=a,c&&b(c,this),d.tivoClient?(this.tivoDevice=d.tivoClient.getDevice(),this.showPinEntryPopup(),d.appHistory.enter(),this):void e.error("init: TiVo Client not set up - please call vmDtvLib's init in your app before calling PinPrompt -- exiting")):void e.error("init: No callback function passed in - exiting")},f.showPinEntryPopup=function(){if(e.debug("showPinEntry"),this.pinEntryPopup)this.pinEntryPopup.show(),this.trackPageTryAgainOption();else{var a=vm_h2jTemplates.lib_uiComponents_pinPrompt_pinPrompt;this.pinEntryPopup=new d.BasicPopup;var b={width:this.PIN_WIDTH,height:this.PIN_HEIGHT,left:this.LEFT_POS,top:this.TOP_POS,alpha:this.opaque?1:null,title:this.PIN_TITLE_ENTER,body:a};this.pinEntryPopup.init(b),this.LEFT_POS||this.TOP_POS||this.pinEntryPopup.centre(),this.setDescription(this.INSTRUCTION_ENTER),this.pinEntryPopup.show();var c=this.pinEntryPopup.getPopupHtmlElement(),f=c.getElementsByClassName("vdl_PinPromptFieldsContainer")[0];this.entryFields=f.childNodes,this.setCurrentActiveEntry(0),this.trackPage(this.DAX_PAGE_ENTRY)}},f.showPinOptionPopup=function(){if(e.debug("showPinOption"),this.pinOptionPopup)this.pinOptionPopup.reset(),this.pinOptionPopup.show();else{this.pinOptionPopup=new d.OptionPopup;var a={width:this.PIN_WIDTH,height:this.PIN_HEIGHT,left:this.LEFT_POS,top:this.TOP_POS,alpha:this.opaque?1:null,title:this.PIN_TITLE_INCORRECT,body:this.INSTRUCTION_INCORRECT_OPTIONS,disableSound:!this.soundsEnabled,idInitialFocus:"TRY_AGAIN"};this.NO_HELP_LINK?a.buttons=[{text:this.BUTTON_CAPTION_AGAIN,id:"TRY_AGAIN"}]:a.buttons=[{text:this.BUTTON_CAPTION_RESET,id:"RESET"},{text:this.BUTTON_CAPTION_AGAIN,id:"TRY_AGAIN"}],this.pinOptionPopup.init(a),this.LEFT_POS||this.TOP_POS||this.pinOptionPopup.centre(),this.NO_HELP_LINK||this.pinOptionPopup.addListener("RESET",this.goToResetPin.bind(this)),this.pinOptionPopup.addListener("TRY_AGAIN",this.tryPinAgain.bind(this)).addListener("CANCEL",this.cancelPin.bind(this)).show()}this.trackPage(this.DAX_PAGE_OPTIONS)},f.goToResetPin=function(){e.debug("goToResetPin"),this.trackResetOption(),d.appHistory.exitToApp(this.HELP_LINK_URL)},f.tryPinAgain=function(){e.debug("tryPinAgain"),this.pinOptionPopup.hide(),this.setMainHeader(this.PIN_TITLE_ENTER),this.setDescription(this.INSTRUCTION_ENTER),this.retry(),this.failedAttempts=0,this.showPinEntryPopup()},f.cancelPin=function(){this.doCallBack(!1),this.closePinPopups()},f.setCurrentActiveEntry=function(a){this.currentIndex=a;var b;for(this.currentIndex<this.keysEntered.length&&this.trimStoredEntries(),b=0;b<this.currentIndex;b++)this.toggleState(this.entryFields[b],"populated",b<this.currentIndex);for(this.entryFields[this.currentIndex]&&this.toggleState(this.entryFields[this.currentIndex],"active",!0),b=this.currentIndex+1;b<this.PIN_LENGTH;b++)this.toggleState(this.entryFields[b],"active",!1)},f.toggleState=function(a,b,c){var d=a.getElementsByClassName("vdl_PinPromptEntryHighlight")[0],e=a.getElementsByClassName("vdl_PinPromptEntryAsterisk")[0];switch(b){case"populated":c?(this.removeClass(e,"vdl_hide"),this.addClass(d,"vdl_hide")):this.addClass(e,"vdl_hide");break;case"active":c?(this.addClass(e,"vdl_hide"),this.removeClass(d,"vdl_hide")):(this.addClass(e,"vdl_hide"),this.addClass(d,"vdl_hide"))}},f.addClass=function(a,b){a.classList.add(b)},f.removeClass=function(a,b){a.classList.remove(b)},f.addToKeys=function(a){this.keysEntered.length<this.PIN_LENGTH&&(this.keysEntered.push(a),this.setCurrentActiveEntry(this.keysEntered.length),this.validatePin())},f.trimStoredEntries=function(){this.keysEntered=this.keysEntered.splice(0,this.currentIndex)},f.validatePin=function(){this.keysEntered.length===this.PIN_LENGTH&&(this.validatingPin=!0,setTimeout(this.validateTivoPin.bind(this),100))},f.validateTivoPin=function(){var a=this.keysEntered.join("");this.tivoDevice.isPinValid(tivo.client.PinType.PARENTAL_CONTROL,a)?(e.debug("PIN CORRECT"),this.validatingPin=!1,this.trackPinResult(!0),this.doCallBack(!0),this.closePinPopups()):(e.debug("PIN WRONG"),this.incorrectEntry(),this.trackPinResult(!1))},f.incorrectEntry=function(){this.failedAttempts++,this.failedAttempts<this.MAX_ATTEMPTS?(this.setMainHeader(this.PIN_TITLE_INCORRECT),this.setDescription(this.INSTRUCTION_INCORRECT),this.retry(),this.trackPage(this.DAX_PAGE_INCORRECT)):(this.pinEntryPopup.hide(),this.showPinOptionPopup())},f.retry=function(){this.setCurrentActiveEntry(0),this.validatingPin=!1},f.setMainHeader=function(a){this.pinEntryPopup.setTitle(a)},f.setDescription=function(a){var b=this.pinEntryPopup.getPopupHtmlElement();b&&(b.getElementsByClassName("vdl_PinPromptDescription")[0].textContent=a)},f.doCallBack=function(a){this.resultCallBackFunc({result:a})},f.trackPage=function(a,b,c){this.lastPage!==a&&(d.dax.pageChange(this.DAX_NAME+"."+a,b?b:null,c?c:null),this.lastPage=a)},f.trackPageTryAgainOption=function(){this.trackPage(this.DAX_PAGE_ENTRY,null,this.DAX_TRY_AGAIN_LABEL)},f.trackResetOption=function(){d.dax.track({ns_type:"hidden",vm_ev_ty:"nav",vm_ev_ac:"out",vm_ev_method:"ok-button",vm_lt_placement:this.DAX_RESET_PIN_LABEL})},f.trackPinResult=function(a){var b=a?this.DAX_RESULT_SUCCESS:this.DAX_RESULT_FAIL+"-"+this.failedAttempts;d.dax.track({ns_type:"hidden",vm_ev_ty:"app",vm_ev_ac:b})},f.closePinPopups=function(){e.debug("closing"),this.pinEntryPopup.deletePopup(),this.pinEntryPopup=null,this.pinOptionPopup&&(this.pinOptionPopup.deletePopup(),this.pinOptionPopup=null)}}(),function(){"use strict";var a=window.vm_h2jTemplates=window.vm_h2jTemplates||{};a.lib_uiComponents_pinPrompt_pinPrompt="<div class=\"vdl_PinPromptContainer\"><div class=\"vdl_PinPromptDescription\"></div><div class=\"vdl_PinPromptFieldsContainer\"><div class='vdl_PinPromptField'><div class='vdl_PinPromptEntryHighlight'></div><div class='vdl_PinPromptEntryField'></div><div class='vdl_PinPromptEntryAsterisk'></div></div><div class='vdl_PinPromptField'><div class='vdl_PinPromptEntryHighlight'></div><div class='vdl_PinPromptEntryField'></div><div class='vdl_PinPromptEntryAsterisk'></div></div><div class='vdl_PinPromptField'><div class='vdl_PinPromptEntryHighlight'></div><div class='vdl_PinPromptEntryField'></div><div class='vdl_PinPromptEntryAsterisk'></div></div><div class='vdl_PinPromptField'><div class='vdl_PinPromptEntryHighlight'></div><div class='vdl_PinPromptEntryField'></div><div class='vdl_PinPromptEntryAsterisk'></div></div></div></div>"}();